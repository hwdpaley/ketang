{
    "version": 3,
    "sources": [
        "../../../src/common/bootstrap/global_safe_save_084748.js"
    ],
    "names": [
        "global",
        "_ip2int",
        "ip",
        "num",
        "split",
        "Number",
        "_int2iP",
        "str",
        "tt",
        "Array",
        "String",
        "encryptPassword",
        "password",
        "md5encoded",
        "think",
        "md5",
        "unique",
        "arr",
        "in_array",
        "stringToSearch",
        "arrayToSearch",
        "s",
        "length",
        "thisEntry",
        "toString",
        "times",
        "d",
        "sec",
        "time",
        "date",
        "Date",
        "y",
        "getFullYear",
        "M",
        "getMonth",
        "getDate",
        "h",
        "getHours",
        "m",
        "getMinutes",
        "getSeconds",
        "sort_node",
        "v",
        "w",
        "sort_node1",
        "get_children",
        "nodes",
        "parent",
        "sn",
        "children",
        "last",
        "node",
        "i",
        "push",
        "sort",
        "jumper",
        "stack",
        "slice",
        "shift_node",
        "shift",
        "list",
        "last_static",
        "top",
        "tree",
        "has_child",
        "current",
        "pop",
        "obj_values",
        "obj",
        "objkey",
        "objarr",
        "forEach",
        "key",
        "isObjectValueEqual",
        "a",
        "b",
        "aProps",
        "bProps",
        "propName",
        "trim",
        "replace",
        "parse_config_attr",
        "strs",
        "search",
        "isArray",
        "n",
        "parse_type_attr",
        "isEmpty",
        "id",
        "name",
        "pid",
        "splice",
        "join",
        "arr_to_tree",
        "ltrim",
        "rtrim",
        "data",
        "result",
        "temp",
        "chnum",
        "sanjiao",
        "len",
        "undefined",
        "sub_cate",
        "get_attribute_type",
        "type",
        "_type",
        "dateformat",
        "extra",
        "D",
        "_date",
        "k",
        "dateformat_",
        "array_search",
        "indexOf",
        "array_diff",
        "arr1",
        "arr2",
        "temparray",
        "get_list_field",
        "grid",
        "controller",
        "module",
        "data2",
        "value",
        "console",
        "log",
        "field",
        "array",
        "call_user_func",
        "format",
        "href",
        "links",
        "val",
        "link",
        "matches",
        "match",
        "show",
        "hrefs",
        "u",
        "query",
        "str_replace",
        "href1",
        "get_action_type",
        "all",
        "cb",
        "params",
        "func",
        "eval",
        "apply",
        "get_nickname",
        "uid",
        "model",
        "config",
        "cache",
        "timeout",
        "get_realname",
        "get_rolename",
        "time_format",
        "time_start",
        "getTime",
        "time_end",
        "subject",
        "count",
        "j",
        "repl",
        "sl",
        "fl",
        "f",
        "concat",
        "r",
        "ra",
        "sa",
        "window",
        "get_url",
        "get_url_vip",
        "doc",
        "userinfo",
        "vip",
        "isVip",
        "wkprice",
        "where",
        "find",
        "res",
        "get_cover",
        "cover_id",
        "picture",
        "get_cover2",
        "qiniu",
        "path",
        "get_pic",
        "map",
        "status",
        "isNumberString",
        "q",
        "QINIU_DOMAIN_NAME",
        "get_pics_one",
        "arr_id",
        "formatprice",
        "price",
        "pr",
        "JSON",
        "parse",
        "present_price",
        "isNumber",
        "formatCurrency",
        "discount_price",
        "get_price_format",
        "prices",
        "get_price",
        "isNaN",
        "sign",
        "Math",
        "abs",
        "floor",
        "cents",
        "substring",
        "formatCurrencyTenThou",
        "getsuk",
        "suk",
        "suk_",
        "ch",
        "v_",
        "k_",
        "v__",
        "k__",
        "extend",
        "createSelfMenu",
        "menu",
        "button",
        "item",
        "m_id",
        "x",
        "sitem",
        "url",
        "media_id",
        "sub_button",
        "buildselfmenu",
        "checkMobile",
        "agent",
        "flag",
        "toLowerCase",
        "keywords",
        "is_weixin",
        "date_from",
        "months",
        "month",
        "day",
        "year",
        "hour",
        "min",
        "image_view",
        "imgReg",
        "srcReg",
        "narr",
        "img",
        "_img",
        "nimg",
        "inputimg",
        "img_text_view",
        "get_file",
        "file_id",
        "file",
        "location",
        "savename",
        "get_cate",
        "cid",
        "get_all_category",
        "column",
        "sort_url",
        "http",
        "get",
        "option",
        "identifier",
        "a2a",
        "a1",
        "a2",
        "isObject",
        "retVal",
        "o2o",
        "MathRand",
        "Num",
        "random",
        "update_cache",
        "priv",
        "catid",
        "roleid",
        "action",
        "is_admin",
        "GetDateStr",
        "AddDayCount",
        "dd",
        "setDate",
        "escape2Html",
        "arrEntities",
        "t",
        "html_decode",
        "html_encode"
    ],
    "mappings": "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",
    "file": "../../../src/common/bootstrap/global_safe_save_084748.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n/**\n * this file will be loaded before server started\n * you can define global functions used in controllers, models, templates\n */\n\n/**\n * use global.xxx to define global functions\n *\n * global.fn1 = function(){\n *\n * }\n *\n *global.xxx = async () => {\n *   let data = await Promise.resolve(111)\n *}\n */\n\n/**\n * ip转数字\n * @param ip\n * @returns {number}\n * @private\n */\n/* global _ip2int(ip)*/\nglobal._ip2int = function(ip) {\n    var num = 0;\n    ip = ip.split(\".\");\n    num = Number(ip[0]) * 256 * 256 * 256 + Number(ip[1]) * 256 * 256 + Number(ip[2]) * 256 + Number(ip[3]);\n    num = num >>> 0;\n    return num;\n}\n/**\n * 数字转ip\n * @param num\n * @returns {string|*}\n * @private\n */\n/*global _int2ip(num: number) */\nglobal._int2iP = function(num) {\n    var str;\n    var tt = new Array();\n    tt[0] = (num >>> 24) >>> 0;\n    tt[1] = ((num << 8) >>> 24) >>> 0;\n    tt[2] = (num << 16) >>> 24;\n    tt[3] = (num << 24) >>> 24;\n    str = String(tt[0]) + \".\" + String(tt[1]) + \".\" + String(tt[2]) + \".\" + String(tt[3]);\n    return str;\n}\n\n/**\n * 密码加密\n * @param password 加密的密码\n * @param md5encoded true-密码不加密，默认加密\n * @returns {*}\n */\n/*global encryptPassword */\nglobal.encryptPassword = function(password, md5encoded) {\n    md5encoded = md5encoded || false;\n    password = md5encoded ? password : think.md5(password);\n    return think.md5(think.md5('www.cmswing.com') + password + think.md5('Arterli'));\n}\n\n/**\n * 数组去重\n * @param arr\n * @returns {Array}\n */\n/* global unique */\nglobal.unique = function(arr) {\n    // var result = [], hash = {};\n    // for (var i = 0, elem; (elem = arr[i]) != null; i++) {\n    //     if (!hash[elem]) {\n    //         result.push(elem);\n    //         hash[elem] = true;\n    //     }\n    // }\n    // return result;\n    return Array.from(new Set(arr));\n}\n/**\n * in_array\n * @param stringToSearch\n * @param arrayToSearch\n * @returns {boolean}\n */\n/* global in_array */\nglobal.in_array = function(stringToSearch, arrayToSearch) {\n    for (let s = 0; s < arrayToSearch.length; s++) {\n        let thisEntry = arrayToSearch[s].toString();\n        if (thisEntry == stringToSearch) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * global times\n * 时间格式化\n * @param d\n * @returns {string}\n */\nglobal.times = function(d, sec) {\n    var time;\n    var date = new Date(d);\n    var y = date.getFullYear();\n    var M = date.getMonth() + 1;\n    M = M < 10 ? \"0\" + M : M;\n    var d = date.getDate();\n    d = d < 10 ? \"0\" + d : d;\n    var h = date.getHours();\n    h = h < 10 ? \"0\" + h : h;\n    var m = date.getMinutes();\n    m = m < 10 ? \"0\" + m : m;\n    var s = date.getSeconds();\n    s = s < 10 ? \"0\" + s : s;\n    if (sec) {\n        time = y + \"-\" + M + \"-\" + d + \" \" + h + \":\" + m + \":\" + s;\n    } else {\n        time = y + \"-\" + M + \"-\" + d + \" \" + h + \":\" + m;\n    }\n\n    return time;\n}\n\n/**\n * 排序函数\n */\nfunction sort_node(v, w) {\n    return v[\"sort\"] - w[\"sort\"];\n}\nfunction sort_node1(v, w) {\n    return w[\"sort\"] - v[\"sort\"];\n}\n/**\n * global get_children\n * 获取子集分类 （这里是获取所有子集）\n */\nglobal.get_children = function(nodes, parent , sn=0) {\n   // console.log(11);\n    var children = [];\n    var last = [];\n    /* 未访问的节点 */\n    /*\n     * 获取根分类列表。\n     * 创建一个虚拟父级分类亦可\n     **/\n    var node = null;\n    for (var i in nodes) {\n        node = nodes[i];\n        if (node[\"pid\"] == parent) {\n            node[\"deep\"] = 0;\n            children.push(node);\n        } else {\n            last.push(node);\n        }\n    }\n    if(sn==0){\n        children.sort(sort_node);\n    }else {\n        children.sort(sort_node1);\n    }\n\n\n    /* 同级排序 */\n    var jumper = 0;\n    var stack = children.slice(0);\n    /* easy clone */\n\n    while (stack.length > 0\n        /* just in case */ && jumper++ < 1000) {\n        var shift_node = stack.shift();\n        var list = [];\n        /* 当前子节点列表 */\n        var last_static = last.slice(0);\n        last = [];\n        for (var i in last_static) {\n            node = last_static[i];\n            if (node[\"pid\"] == shift_node[\"id\"]) {\n                node[\"deep\"] = shift_node[\"deep\"] + 1;\n                list.push(node);\n            } else {\n                last.push(node);\n            }\n        }\n        if(sn==0){\n            list.sort(sort_node);\n        }else {\n            list.sort(sort_node1);\n        }\n\n\n        for (var i in list) {\n            node = list[i];\n            stack.push(node);\n            children.push(node);\n        }\n    }\n    /*\n     * 有序树非递归前序遍历\n     *\n     * */\n    var stack = [];\n    /* 前序操作栈 - 分类编号 */\n    var top = null;\n    /* 操作栈顶 */\n    var tree = children.slice(0);\n    /* 未在前序操作栈内弹出的节点 */\n    var has_child = false;\n    /* 是否有子节点，如无子节点则弹出栈顶 */\n    var children = [];\n    /* 清空结果集 */\n    var jumper = 0;\n    last = [];\n    /* 未遍历的节点 */\n    var current = null;\n    /* 当前节点 */\n    stack.push(parent);\n    /* 建立根节点 */\n\n    while (stack.length > 0) {\n        if (jumper++ > 1000) {\n            break;\n        }\n        top = stack[stack.length - 1];\n        has_child = false;\n        last = [];\n\n        for (var i in tree) {\n            current = tree[i];\n            if (current[\"pid\"] == top) {\n                top = current[\"id\"];\n                stack.push(top);\n                children.push(current);\n                has_child = true;\n            } else {\n                last.push(current);\n            }\n        }\n        tree = last.slice(0);\n        if (!has_child) {\n            stack.pop();\n            top = stack[stack.length - 1];\n        }\n    }\n    return children;\n}\n/**\n * obj_values(obj);\n * 获取对象中的所有的值，并返回数组\n * @param obj\n * @returns {Array}\n */\n/* global obj_values */\nglobal.obj_values = function(obj) {\n    let objkey = Object.keys(obj);\n    let objarr = [];\n    objkey.forEach(key => {\n        objarr.push(obj[key]);\n    })\n    return objarr;\n}\n/**\n * 判断对象是否相等\n * @param a\n * @param b\n * @returns {boolean}\n */\n/* global isObjectValueEqual */\nglobal.isObjectValueEqual = function(a, b) {\n    // Of course, we can do it use for in\n    // Create arrays of property names\n    var aProps = Object.getOwnPropertyNames(a);\n    var bProps = Object.getOwnPropertyNames(b);\n\n    // If number of properties is different,\n    // objects are not equivalent\n    if (aProps.length != bProps.length) {\n        return false;\n    }\n\n    for (var i = 0; i < aProps.length; i++) {\n        var propName = aProps[i];\n\n        // If values of same property are not equal,\n        // objects are not equivalent\n        if (a[propName] !== b[propName]) {\n            return false;\n        }\n    }\n\n    // If we made it this far, objects\n    // are considered equivalent\n    return true;\n}\n/**\n * trim()\n * @param str [删除左右两端的空格]\n * @returns {*|void|string|XML}\n */\n/* global trim */\nglobal.trim = function(str) {\n    return str.replace(/(^\\s*)|(\\s*$)/g, \"\");\n}\n/**\n * 分析枚举类型配置值 格式 a:名称1,b:名称2\n * @param str\n * @returns {*}\n */\n/* global parse_config_attr */\nglobal.parse_config_attr = function(str) {\n    let strs;\n    if (str.search(/\\r\\n/ig) > -1) {\n        strs = str.split(\"\\r\\n\");\n    } else if (str.search(/,/ig) > -1) {\n        strs = str.split(\",\");\n    } else if(str.search(/\\n/ig) > -1){\n        strs = str.split(\"\\n\");\n    }else {\n        strs = [str];\n    }\n    if (think.isArray(strs)) {\n        let obj = {}\n        strs.forEach(n => {\n            n = n.split(\":\");\n            obj[n[0]] = n[1];\n        })\n        return obj;\n    }\n\n}\nglobal.parse_type_attr = function (str) {\n    let strs;\n    if (str.search(/\\r\\n/ig) > -1) {\n        strs = str.split(\"\\r\\n\");\n    } else if (str.search(/,/ig) > -1) {\n        strs = str.split(\",\");\n    } else if(str.search(/\\n/ig) > -1){\n        strs = str.split(\"\\n\");\n    }else {\n        strs = [str];\n    }\n    if(think.isArray(strs)){\n            let arr = [];\n            for (let v of strs){\n                let obj = {};\n                v = v.split(\":\");\n                if(!think.isEmpty(v[0])&&!think.isEmpty(v[1])){\n                obj.id = v[0];\n                obj.name = v[1];\n                if(obj.id.split(\".\").length ==1){\n                    obj.pid = 0\n                }else {\n                    obj.pid = obj.id.split(\".\").splice(0,obj.id.split(\".\").length-1).join(\".\");\n                }\n                arr.push(obj);\n                }\n            }\n        //console.log(arr);\n        let tree = arr_to_tree(arr,0)\n       //think.log(tree);\n        return tree;\n    }\n\n}\n/**\n * ltrim()\n * @param str [删除左边的空格]\n * @returns {*|void|string|XML}\n */\n/* global ltrim */\nglobal.ltrim = function(str) {\n    return str.replace(/(^\\s*)/g, \"\");\n}\n/**\n *\n * rtrim()\n * @param str [删除右边的空格]\n * @returns {*|void|string|XML}\n */\n/* global rtrim */\nglobal.rtrim = function(str) {\n    return str.replace(/(\\s*$)/g, \"\");\n}\n/**\n * 把返回的数据集转换成Tree\n * @param array data 要转换的数据集\n * @param string pid parent标记字段\n * @return array\n */\n/* global arr_to_tree */\nglobal.arr_to_tree = function(data, pid) {\n    var result = [], temp;\n    var length=data.length;\n    for(var i=0;i<length;i++) {\n        if (data[i].pid == pid) {\n            result.push(data[i]);\n            temp = arr_to_tree(data, data[i].id);\n            if (temp.length > 0) {\n                data[i].children = temp;\n                data[i].chnum =data[i].children.length\n            }\n        }\n    }\n    return result;\n}\n//计算分类信息当前状态\nglobal.sanjiao = (arr)=>{\n    var result = [];\n    for(var i = 0,len = arr.length;i<len;i++){\n        result.push(result[i - 1]!==undefined?result[i - 1]+'.'+arr[i]:arr[i]);\n    }\n    return result;\n}\n/* global arr_to_tree */\nglobal.sub_cate = function(data, pid) {\n    var result = [], temp;\n    var length=data.length;\n    for(var i=0;i<length;i++) {\n        if (data[i].pid == pid) {\n            //console.log(data[i]);\n            result.push(data[i].id);\n            temp = sub_cate(data, data[i].id);\n            if (temp.length > 0) {\n                result.push(temp.join(','));\n            }\n        }\n    }\n    return result;\n}\n// 获取属性类型信息\n/* global get_attribute_type */\nglobal.get_attribute_type = function(type) {\n    // TODO 可以加入系统配置\n    let _type = {\n        'num': ['数字', 'int(10) unsigned NOT NULL'],\n        'string': ['字符串', 'varchar(255) NOT NULL'],\n        'textarea': ['文本框', 'text NOT NULL'],\n        'date': ['日期', 'bigint(13) NOT NULL'],\n        'datetime': ['时间', 'bigint(13) NOT NULL'],\n        'bool': ['布尔', 'tinyint(2) NOT NULL'],\n        'select': ['枚举', 'char(50) NOT NULL'],\n        'radio': ['单选', 'char(10) NOT NULL'],\n        'checkbox': ['多选', 'varchar(100) NOT NULL'],\n        'editor': ['编辑器', 'text NOT NULL'],\n        'picture': ['上传图片', 'int(10) unsigned NOT NULL'],\n        'file': ['上传附件', 'int(10) unsigned NOT NULL'],\n        'suk': ['商品规格', 'text NOT NULL'],\n        'pics': ['多图上传', 'varchar(255) NOT NULL'],\n        'price': ['价格', 'varchar(255) NOT NULL'],\n        'freight': ['运费', 'varchar(255) NOT NULL'],\n        'keyword': ['关键词', 'varchar(255) NOT NULL'],\n        'relation': ['关联', 'int(10) unsigned NOT NULL']\n    }\n    return type ? _type[type][0] : _type;\n}\n/**\n * 时间戳格式化 dateformat()\n * @param extra 'Y-m-d H:i:s'\n * @param date  时间戳\n * @return  '2015年12月17日 15:39:44'\n */\n/* global dateformat */\nglobal.dateformat = function(extra, date) {\n    let D = new Date(date);\n    let time = {\n        \"Y\": D.getFullYear()+'年',\n        'm': D.getMonth() + 1+'月',\n        'd': D.getDate()+'日',\n        'H': D.getHours(),\n        'i': D.getMinutes(),\n        's': D.getSeconds()\n    }\n    let key = extra.split(/\\W/);\n    let _date;\n    for (let k of key) {\n        time[k] = time[k] < 10 ? \"0\" + time[k] : time[k]\n        _date = extra.replace(k, time[k])\n        extra = _date;\n    }\n    return _date.replace('-','').replace('-','');\n}\nglobal.dateformat_ = function(extra, date) {\n    let D = new Date(date);\n    let time = {\n        \"Y\": D.getFullYear(),\n        'm': D.getMonth() + 1,\n        'd': D.getDate(),\n        'H': D.getHours(),\n        'i': D.getMinutes(),\n        's': D.getSeconds()\n    }\n    let key = extra.split(/\\W/);\n    let _date;\n    for (let k of key) {\n        time[k] = time[k] < 10 ? \"0\" + time[k] : time[k]\n        _date = extra.replace(k, time[k])\n        extra = _date;\n    }\n    return _date;\n}\n/* global array_search */\nglobal.array_search = function(arr, str) {\n    // 如果可以的话，调用原生方法\n    if (arr && arr.indexOf) {\n        return arr.indexOf(str);\n    }\n\n    var len = arr.length;\n    for (var i = 0; i < len; i++) {\n        // 定位该元素位置\n        if (arr[i] == str) {\n            return i;\n        }\n    }\n\n    // 数组中不存在该元素\n    return false;\n}\n/* global array_diff */\nglobal.array_diff = function(arr1, arr2) {\n    //var arr1 = [\"i\", \"b\", \"c\", \"d\", \"e\", \"f\",\"x\",\"\"]; //数组A\n    //var arr2 = [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"];//数组B\n    var temp = []; //临时数组1\n    var temparray = [];//临时数组2\n    for (var i = 0; i < arr2.length; i++) {\n        temp[arr2[i]] = true;//巧妙地方：把数组B的值当成临时数组1的键并赋值为真\n    }\n    for (var i = 0; i < arr1.length; i++) {\n        if (!temp[arr1[i]]) {\n            temparray.push(arr1[i]);//巧妙地方：同时把数组A的值当成临时数组1的键并判断是否为真，如果不为真说明没重复，就合并到一个新数组里，这样就可以得到一个全新并无重复的数组\n        }\n    }\n    ;\n    //if(think.isEmpty(temparray)){\n    //    return \n    //}\n    return temparray;\n}\n//global.call_user_func = function (cb, params) {\n//    let func = global.cb;\n//    func.apply(cb, params);\n//}\n/* 解析列表定义规则*/\n/* global get_list_field */\nglobal.get_list_field = function(data, grid, controller, module) {\n    module = module || \"admin\";\n    //console.log(module);\n    let data2 = {};\n    let value;\n\n    // 获取当前字段数据\n    console.log(\"grid-----------\"+grid);\n    for (let field of grid.field) {\n        let temp;\n        let array = field.split('|');//TODO\n        //console.log(array);\n        temp = data[array[0]];\n        //console.log(temp);\n        // 函数支持\n        if (!think.isEmpty(array[1])) {\n            temp = call_user_func(array[1], temp);\n        }\n        data2[array[0]] = temp;\n    }\n    console.log(\"data2--------\"+JSON.stringify(data2));\n    if (!think.isEmpty(grid.format)) {\n        // value  =   preg_replace_callback('/\\[([a-z_]+)\\]/', function($match) use($data2){return $data2[$match[1]];}, $grid['format']);\n    } else {\n        value = data2[Object.keys(data2)];\n    }\n\n    // 链接支持\n    if ('title' == grid.field[0] && '目录' == data.type) {\n        // 目录类型自动设置子文档列表链接\n        grid.href = '[LIST]';\n    } else if ('title' == grid.field[0]) {\n        grid.href = '[EDIT]';\n    }\n\n    if (!think.isEmpty(grid.href)) {\n\n        let links = grid.href.split(',');\n\n        let val = []\n        for (let link of links) {\n            let array = link.split('|');\n            let href = array[0];\n\n            //console.log(href);\n            let matches = href.match(/^\\[([a-z_]+)\\]$/);\n            if (matches) {\n                val.push(data2[matches[1]])\n                // console.log(val);\n            } else {\n                let show = !think.isEmpty(array[1]) ? array[1] : value;\n                // console.log(show)\n                // 替换系统特殊字符串\n                let hrefs = {\n                    '[DELETE]': 'setstatus/status/-1/ids/[id]',\n                    '[EDIT]': 'edit/id/[id]/model/[model_id]/cate_id/[category_id]',\n                    '[LIST]': 'index/pid/[id]/model/[model_id]/cate_id/[category_id]'\n                }\n                let match = hrefs[href].match(/\\[(\\S+?)\\]/g);\n                // console.log(match);\n                let u = [];\n                for (let k of match) {\n                    let key = k.replace(/(^\\[)|(\\]$)/g, \"\");\n                    u.push(data[key]);\n                }\n                // console.log(u);\n                let query = str_replace(match, u, hrefs[href]);\n                let href1 = `/${module}/${controller}/${query}`;\n                //console.log(query);\n                if (href == \"[DELETE]\") {\n                    val.push('<a href=\"' + href1 + '\" class=\"text-info ajax-get confirm\">' + show + '</a> ');\n                } else {\n                    val.push('<a href=\"' + href1 + '\" class=\"text-info\">' + show + '</a> ');\n                }\n            }\n        }\n        value = val.join(\" \");\n    }\n    // console.log(\"get_list_field------,\"+value)\n    return value;\n}\n\n/**\n * 获取行为类型\n * @param intger type 类型\n * @param bool all 是否返回全部类型\n * @author arterli <arterli@qq.com>\n */\n/* global get_action_type */\nglobal.get_action_type = function(type, all) {\n    all = all || false;\n    let list = {\n        1: '系统',\n        2: '用户',\n    };\n    if (all) {\n        return list;\n    }\n    return list[type];\n}\n\n\n/**\n * 返回一个自定义用户函数给出的第一个参数\n *  call_user_func（回调 函数名， [参数]）\n * @param cb  函数名\n * @param params 数组格式传入参数\n */\n/* global call_user_func */\nglobal.call_user_func = function(cb, params) {\n    let func = eval(cb);\n    if (!think.isArray(params)) {\n        params = [params];\n    }\n    return func.apply(cb, params);\n}\n\n/**\n *根据uid获取用户昵称\n * @param uid 用户id\n * @returns Promise {*}\n */\n/* global get_nickname */\nglobal.get_nickname = async (uid) => {\n    //console.log(uid);\n    let data = await think.model('member', think.config(\"db\")).cache({\n        timeout: 1000,\n        type: \"file\" //使用文件方式缓存\n    }).get_nickname(uid)\n    return data;\n}\nglobal.get_realname = async (uid) => {\n    //console.log(uid);\n    let data = await think.model('member', think.config(\"db\")).cache({\n        timeout: 1000,\n        type: \"file\" //使用文件方式缓存\n    }).get_realname(uid)\n    return data;\n}\nglobal.get_rolename = async (uid) => {\n    //console.log(uid);\n    let data = await think.model('auth_role', think.config(\"db\")).cache({\n        timeout: 1000,\n        type: \"file\" //使用文件方式缓存\n    }).get_rolename(uid)\n    return data;\n}\n//时间格式\n/* global time_format */\nglobal.time_format = (time) => {\n    return dateformat('Y-m-d H:i:s', time);\n}\nglobal.time_start = (time) => {\n    let a=dateformat_('Y-m-d',time);\n    let b=new Date(a).getTime();\n    console.log(\"time_start----------\"+a+\",\"+b);\n    return b;\n}\nglobal.time_end = (time) => {\n    let a=dateformat_('Y-m-d',time);\n    let b=new Date(a).getTime()+24*60*60*1000;\n    console.log(\"time_end----------\"+a+\",\"+b);\n    return b;\n}\n/* global str_replace()\n * str_replace(条件[]，替换内容[],被替换的内容)\n * @param search\n * @param replace\n * @param subject\n * @param count\n * @returns {*}\n */\n/* global str_replace */\nglobal.str_replace = function(search, replace, subject, count) {\n    var i = 0, j = 0, temp = '', repl = '', sl = 0, fl = 0,\n        f = [].concat(search),\n        r = [].concat(replace),\n        s = subject,\n        ra = r instanceof Array, sa = s instanceof Array;\n    s = [].concat(s);\n    if (count) {\n        this.window[count] = 0;\n    }\n\n    for (i = 0, sl = s.length; i < sl; i++) {\n        if (s[i] === '') {\n            continue;\n        }\n        for (j = 0, fl = f.length; j < fl; j++) {\n            temp = s[i] + '';\n            repl = ra ? (r[j] !== undefined ? r[j] : '') : r[0];\n            s[i] = (temp).split(f[j]).join(repl);\n            if (count && s[i] !== temp) {\n                this.window[count] += (temp.length - s[i].length) / f[j].length;\n            }\n        }\n    }\n    return sa ? s : s[0];\n}\n/**\n * 获取文档地址\n * @param name 文档表示\n * @param id   文档id\n * @returns {*}\n */\nglobal.get_url = (name, id) => {\n\n    if (!think.isEmpty(name)) {\n        return `/p/${name}.html`;\n    } else {\n        return `/p/${id}.html`;\n    }\n}\n/**\n * 获取文档地址,是否VIP文档，检查是否vip用户，返回地址\n * @param doc 文档info\n * @param userinfo 用户info\n * @param id   文档id\n * @param userid   用户id\n * @returns {*}\n */\nglobal.get_url_vip =async (doc,userinfo) => {\n    \n    // console.log(\"userinfo----------\"+time_start(new Date())+\",\"+time_end(new Date()));\n    // console.log(\"userinfo----------\"+time_end(new Date()));\n    if(userinfo.uid==0){//未登录\n        return `javascript:_show('请登录，谢谢');`;\n    }\n    if(doc.vip!=1){\n        return `/p/${doc.id}.html`;\n    }\n    if(userinfo.isVip!=1){\n        return `javascript:_show();`;\n    }\n    if(doc.wkprice > 0)\n    {\n        // console.log(\"doc----------\"+JSON.stringify(doc.id));\n        //检查用户是否购买了该文档\n        let res = await think.model('doc_user', think.config(\"db\")).where({ 'docid': doc.id,'uid':userinfo.uid }).find();\n        // console.log(\"res----------\"+JSON.stringify(res));\n        if(think.isEmpty(res)){\n            return `javascript:_show();`;\n        }\n    }\n    return `/p/${doc.id}.html`;\n}\n/**\n * 获取文档封面图片\n * @param int cover_id\n * @param string field\n * @return 完整的数据  或者  指定的field字段值\n * @author arterli <arterli@qq.com>\n */\n/*global get_cover*/\nglobal.get_cover = async (cover_id, field) => {\n\n    if (think.isEmpty(cover_id)) {\n        return false;\n    }\n    let picture = await think.model('picture', think.config(\"db\")).where({ 'status': 1 }).find(cover_id);\n    return think.isEmpty(field) ? picture : picture[field];\n}\nglobal.get_cover2 = async (cover_id,qiniu) => {\n\n    if (think.isEmpty(cover_id)) {\n        return false;\n    }\n    let picture = await think.model('picture', think.config(\"db\")).where({ 'status': 1 }).find(cover_id);\n    let path='//' + qiniu + '/' +picture.path;\n    return path;\n}\n/**\n *\n * @param id\n * @param m\n * /0/w/<LongEdge>/h/<ShortEdge> \t限定缩略图的长边最多为<LongEdge>，短边最多为<ShortEdge>，进行等比缩放，不裁剪。如果只指定 w 参数则表示限定长边（短边自适应），只指定 h 参数则表示限定短边（长边自适应）。\n * /1/w/<Width>/h/<Height> \t限定缩略图的宽最少为<Width>，高最少为<Height>，进行等比缩放，居中裁剪。转后的缩略图通常恰好是 <Width>x<Height> 的大小（有一个边缩放的时候会因为超出矩形框而被裁剪掉多余部分）。如果只指定 w 参数或只指定 h 参数，代表限定为长宽相等的正方图。\n * /2/w/<Width>/h/<Height> \t限定缩略图的宽最多为<Width>，高最多为<Height>，进行等比缩放，不裁剪。如果只指定 w 参数则表示限定宽（长自适应），只指定 h 参数则表示限定长（宽自适应）。它和模式0类似，区别只是限定宽和高，不是限定长边和短边。从应用场景来说，模式0适合移动设备上做缩略图，模式2适合PC上做缩略图。\n * /3/w/<Width>/h/<Height> \t限定缩略图的宽最少为<Width>，高最少为<Height>，进行等比缩放，不裁剪。如果只指定 w 参数或只指定 h 参数，代表长宽限定为同样的值。你可以理解为模式1是模式3的结果再做居中裁剪得到的。\n * /4/w/<LongEdge>/h/<ShortEdge> \t限定缩略图的长边最少为<LongEdge>，短边最少为<ShortEdge>，进行等比缩放，不裁剪。如果只指定 w 参数或只指定 h 参数，表示长边短边限定为同样的值。这个模式很适合在手持设备做图片的全屏查看（把这里的长边短边分别设为手机屏幕的分辨率即可），生成的图片尺寸刚好充满整个屏幕（某一个边可能会超出屏幕）。\n * /5/w/<LongEdge>/h/<ShortEdge> \t限定缩略图的长边最少为<LongEdge>，短边最少为<ShortEdge>，进行等比缩放，居中裁剪。如果只指定 w 参数或只指定 h 参数，表示长边短边限定为同样的值。同上模式4，但超出限定的矩形部分会被裁剪。\n * @param w 宽\n * @param h 高\n */\nglobal.get_pic = async(id,m=null,w=null,h=null)=>{\n    if(think.isEmpty(id)){\n        return \"/static/noimg.jpg\";\n    }\n    let map={};\n    map.status=1;\n    if(think.isNumberString(id)){\n       map.id=id;\n    }else {\n        map.path = id;\n    }\n    let picture = await think.model('picture', think.config(\"db\")).where(map).find();\n    if(think.isEmpty(picture)){\n        return \"/static/noimg.jpg\";\n    }\n    let q=\"\";\n    if(picture.type > 0){\n       if(m !=null){\n           m=\"/\"+m\n       }else {\n           m=\"\"\n       }\n        if(w != null){\n            w=\"/w/\"+w\n        }else {\n            w=\"\"\n        }\n        if(h !=null){\n            h = \"/h/\"+h\n        }else {\n            h=\"\"\n        }\n        if(m != \"\" || w != \"\" || h != \"\"){\n             q = `?imageView2${m}${w}${h}`\n        }\n        let name = await think.cache(\"setup\");\n        return `//${name.QINIU_DOMAIN_NAME}/${picture.path}${q}`;\n    }else {\n        return picture.path\n    }\n}\n/**\n * 获取多图封面\n * @param array arr_id\n * @param string field\n * @return 完整的数据或者 指定的field字段值\n * @author arterli <arterli@qq.com>\n */\n/*global get_pics_one */\nglobal.get_pics_one = async (arr_id, field) => {\n    if (think.isEmpty(arr_id)) {\n        return false;\n    }\n    var arr = arr_id.split(\",\");\n    return get_cover(arr[0], field);\n\n}\n//{present_price:100,discount_price:80}\nglobal.formatprice = function(price) {\n    let pr = JSON.parse(price);\n    var present_price;\n    //console.log(pr);\n    if (think.isNumber(pr.present_price)) {\n        pr.present_price = pr.present_price.toString();\n    }\n    var price = pr.present_price.split(\"-\");\n    if (price.length > 1) {\n        present_price = formatCurrency(price[0]) + \"-\" + formatCurrency(price[1]);\n    } else {\n        present_price = formatCurrency(price[0])\n    }\n    if (pr.discount_price == 0) {\n        return `<span class=\"text-xs\"><span class=\"text-danger\">现价:￥${present_price}</span></span>`;\n    } else {\n        return `<span class=\"text-xs\"><span class=\"text-danger\">现价:￥${present_price}</span> <br>原价:￥${formatCurrency(pr.discount_price)}</span>`;\n    }\n\n}\n//获取价格格式化\nglobal.get_price_format = function(price, type) {\n    let pr = JSON.parse(price);\n\n    if (1 == type) {\n        if (think.isNumber(pr.present_price)) {\n            pr.present_price = pr.present_price.toString();\n        }\n        let prices = pr.present_price.split(\"-\");\n        let present_price;\n        if (prices.length > 1) {\n            present_price = formatCurrency(prices[0]) + \"-\" + formatCurrency(prices[1]);\n        } else {\n            present_price = formatCurrency(prices[0])\n        }\n        price = present_price;\n    } else {\n\n        if (pr.discount_price == 0) {\n            price = \"\";\n        } else {\n            price = formatCurrency(pr.discount_price);\n        }\n\n    }\n    return price;\n}\n//获取价格不格式化\nglobal.get_price = function(price, type) {\n    if (price) {\n        price = JSON.parse(price);\n        if (1 == type) {\n            return price.present_price;\n        } else {\n            if (price.discount_price == 0) {\n                return \"\";\n            } else {\n                return price.discount_price;\n            }\n\n        }\n    }\n}\n\n/**\n * 将数值四舍五入(保留2位小数)后格式化成金额形式\n *\n * @param num 数值(Number或者String)\n * @return 金额格式的字符串,如'1,234,567.45'\n * @type String\n */\n/*global formatCurrency */\nglobal.formatCurrency = function(num) {\n    num = num.toString().replace(/\\$|\\,/g, '');\n    if (isNaN(num))\n        num = \"0\";\n    let sign = (num == (num = Math.abs(num)));\n    num = Math.floor(num * 100 + 0.50000000001);\n    let cents = num % 100;\n    num = Math.floor(num / 100).toString();\n    if (cents < 10)\n        cents = \"0\" + cents;\n    for (let i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++)\n        num = num.substring(0, num.length - (4 * i + 3)) + ',' +\n            num.substring(num.length - (4 * i + 3));\n    return (((sign) ? '' : '-') + num + '.' + cents);\n}\n\n/**\n * 将数值四舍五入(保留1位小数)后格式化成金额形式\n *\n * @param num 数值(Number或者String)\n * @return 金额格式的字符串,如'1,234,567.4'\n * @type String\n */\n/*global formatCurrencyTenThou */\nglobal.formatCurrencyTenThou = function(num) {\n    num = num.toString().replace(/\\$|\\,/g, '');\n    if (isNaN(num))\n        num = \"0\";\n    let sign = (num == (num = Math.abs(num)));\n    num = Math.floor(num * 10 + 0.50000000001);\n    let cents = num % 10;\n    num = Math.floor(num / 10).toString();\n    for (let i = 0; i < Math.floor((num.length - (1 + i)) / 3); i++)\n        num = num.substring(0, num.length - (4 * i + 3)) + ',' +\n            num.substring(num.length - (4 * i + 3));\n    return (((sign) ? '' : '-') + num + '.' + cents);\n}\n/**\n * 获取商品suk suk, arr:类型数组\n */\n\n/*global getsuk */\nglobal.getsuk = function(suk, arr) {\n    //console.log(suk);\n    var suk_;\n    suk.forEach(function(v, k) {\n\n        if (v.name == arr[0]) {\n            if (v.ch) {\n                v.ch.forEach(function(v_, k_) {\n                    if (v_.name == arr[1]) {\n                        if (v_.ch) {\n                            v_.ch.forEach(function(v__, k__) {\n                                if (v__.name == arr[2]) {\n\n                                    suk_ =think.extend( v__,v_,v);\n                                }\n                            })\n                        } else {\n                            suk_ = think.extend( v_,v);\n                        }\n\n                    }\n                })\n            } else {\n                suk_ = v;\n            }\n        }\n    })\n    return suk_;\n}\n\n/**\n * 构建微信菜单数据结构\n * @param data\n * @returns {{menu: {button: Array}}}\n */\nglobal.createSelfMenu = function(data) {\n    let menu = {\n        \"menu\": {\n            \"button\": []\n        }\n    };\n    let button = [];\n    for (var i = 0; i < data.length; i++) {\n        if (data[i].pid == '0') {\n            let item = {\n                \"id\": data[i].id,\n                \"m_id\": data[i].m_id,\n                \"pid\": data[i].pid,\n                \"type\": data[i].type,\n                \"name\": data[i].name,\n                \"sort\": data[i].sort,\n                \"sub_button\": []\n            };\n            menu.menu.button.push(item);\n            button.push(item);\n        }\n    }\n    for (var x = 0; x < button.length; x++) {\n        for (var y = 0; y < data.length; y++) {\n            if (data[y].pid == button[x].m_id) {\n                let sitem = {\n                    \"type\": data[y].type,\n                    \"m_id\":data[y].m_id,\n                    \"sort\": data[y].sort,\n                    \"name\": data[y].name,\n                    \"url\": data[y].url,\n                    \"media_id\": data[y].media_id\n                };\n                button[x].sub_button.push(sitem);\n            }\n        }\n    }\n    return menu;\n};\n\n/**\n * 微信创建自定义菜单接口\n * 数据构建\n */\n\nglobal.buildselfmenu = function(data){\n    let menu = {\n                  \"button\": []\n                };\n    let button = [];\n    for (var i = 0; i < data.length; i++) {\n        if (data[i].pid == '0') {\n            let item = {\n                \"id\": data[i].id,\n                \"m_id\": data[i].m_id,\n                \"pid\": data[i].pid,\n                \"type\": data[i].type,\n                \"name\": data[i].name,\n                \"sort\": data[i].sort,\n                \"sub_button\": []\n            };\n            menu.menu.button.push(item);\n            button.push(item);\n        }\n    }\n    for (var x = 0; x < button.length; x++) {\n        for (var y = 0; y < data.length; y++) {\n            if (data[y].pid == button[x].m_id) {\n                let sitem = {\n                    \"type\": data[y].type,\n                    \"sort\": data[y].sort,\n                    \"name\": data[y].name,\n                    \"url\": data[y].url,\n                    \"media_id\": data[y].media_id\n                };\n                button[x].sub_button.push(sitem);\n            }\n        }\n    }\n    return menu;\n}\n\n/**\n * 验证是否为智能手机\n * @ param {string} data :this.userAgent;\n * @ return {bool}\n */\n/** global checkMobile */\nglobal.checkMobile = function(agent) {\n    let flag = false;\n    agent = agent.toLowerCase();\n    let keywords = [\"android\", \"iphone\", \"ipod\", \"ipad\", \"windows phone\", \"mqqbrowser\"];\n\n    //排除 Windows 桌面系统  \n    if (!(agent.indexOf(\"windows nt\") > -1) || (agent.indexOf(\"windows nt\") > -1 && agent.indexOf(\"compatible; msie 9.0;\") > -1)) {\n        //排除苹果桌面系统  \n        if (!(agent.indexOf(\"windows nt\") > -1) && !agent.indexOf(\"macintosh\") > -1 && !(agent.indexOf(\"ipad\")>-1)) {\n            for (let item of keywords) {\n                if (agent.indexOf(item) > -1) {\n                    flag = true;\n                    break;\n                }\n            }\n        }\n    }\n    return flag;\n}\n/**\n * 验证时否是微信\n *\n */\nglobal.is_weixin=(agent)=>{\n    let flag = false;\n    agent = agent.toLowerCase();\n    //let key = [\"mqqbrowser\",\"micromessenger\"];\n    let key = [\"micromessenger\"];\n    //排除 Windows 桌面系统\n    if (!(agent.indexOf(\"windows nt\") > -1) || (agent.indexOf(\"windows nt\") > -1 && agent.indexOf(\"compatible; msie 9.0;\") > -1)) {\n        //排除苹果桌面系统\n        if (!(agent.indexOf(\"windows nt\") > -1) && !agent.indexOf(\"macintosh\") > -1) {\n            for (let item of key) {\n                if (agent.indexOf(item) > -1) {\n                    flag = true;\n                    break;\n                }\n            }\n        }\n    }\n    return flag;\n\n}\n/**\n *\n * @param time\n * @returns {string}'January 31, 2018 15:03:26'\n */\nglobal.date_from=(time)=>{\n    // January 31, 2018 15:03:26\n    let months = [\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\", \"September\",\"October\",\"November\",\"December\"]\n    let d = new Date(time)\n    let month = months[d.getMonth()];\n    let day = d.getDate();\n    let year = d.getFullYear();\n    let hour = d.getHours()<10?`0${d.getHours()}`:d.getHours();\n    let min =d.getMinutes()<10?`0${d.getMinutes()}`:d.getMinutes();\n    let sec =d.getSeconds()<10?`0${d.getSeconds()}`:d.getSeconds();\n    let res = `${month} ${day}, ${year} ${hour}:${min}:${sec}`;\n    return res;\n}\n\nglobal.image_view=(str,w,m)=>{\n    //console.log(info);\n    let imgReg = /<img.*?(?:>|\\/>)/gi;\n    let srcReg = /src=[\\'\\\"]?([^\\'\\\"]*)[\\'\\\"]?/i;\n    let arr = str.match(imgReg);\n    if(!think.isEmpty(arr)){\n        let narr=[];\n        for(let img of arr){\n            let _img = img.match(srcReg)\n            //console.log(_img);\n            let nimg = _img[1]+'?imageView2/'+m+'/w/'+w;\n            //console.log(nimg)\n            let inputimg = _img['input'].replace(_img[1],nimg)\n            narr.push(inputimg);\n        }\n        return str_replace(arr, narr, str);\n    }else {\n        return str;\n    }\n}\nglobal.img_text_view=(str,w,h)=>{\n    //console.log(info);\n    let imgReg = /<img.*?(?:>|\\/>)/gi;\n    let srcReg = /src=[\\'\\\"]?([^\\'\\\"]*)[\\'\\\"]?/i;\n    if(think.isEmpty(str)){\n        return []\n    }\n    let arr = str.match(imgReg);\n    if(!think.isEmpty(arr)){\n        let narr=[];\n        for(let img of arr){\n            let _img = img.match(srcReg)\n            //console.log(_img[1]);\n            let nimg =_img[1];\n            if(!think.isEmpty(w) && !think.isEmpty(h)){\n                nimg = _img[1]+'?imageView2/1/w/'+w+'/h/'+h;\n            }\n            //console.log(nimg)\n            narr.push(nimg);\n        }\n        //console.log(narr);\n        return narr;\n    }else {\n        return [];\n    }\n}\n/**\n * 获取文件信息\n * @param file_id 文件id\n * @param field 字段名,如果为空则返回整个记录集\n * @returns {*}\n */\nglobal.get_file=async (file_id,field,key=false)=>{\n\n    if (think.isEmpty(file_id)) {\n        return false;\n    }\n    let file = await think.model('file', think.config(\"db\")).find(file_id);\n    if(file.location==1 && key){\n        let name = await think.cache(\"setup\");\n        file.savename = `http://${name.QINIU_DOMAIN_NAME}/${file.savename}?download/${file.savename}`\n    }\n    return think.isEmpty(field) ? file : file[field];\n}\n/**\n *\n * 根据栏目ID获取栏目信息\n * @param cid\n * @returns {*}\n */\nglobal.get_cate=async(cid)=>{\n    let column = await think.model('category', think.config(\"db\")).get_all_category();\n\n    for(let v of column){\n        if(v.id==cid){\n           // console.log(v)\n           return v;\n        }\n    }\n}\n/**\n * 获取分类信息url\n * @param id\n * @param val\n * @param arr\n */\nglobal.sort_url = (id,val,arr,http)=>{\n    console.log(http.get(val))\n    let url;\n        url=`${val}_${id}`;\n        for(let v of arr){\n            if(v.option.identifier != val){\n                url += `|${v.option.identifier}_${http[v.option.identifier]||0}`\n            }\n        }\n    //console.log(url);\n    return url;\n}\n/*\n *比较数组是否完全相同\n */\nglobal.a2a = function (a1,a2){\n    if(!(think.isArray(a1) && think.isArray(a2))){\n        return false;\n    }\n    if(a1.length != a2.length){\n        return false;\n    }\n\n    a1.sort();\n    a2.sort();\n    for(var i=0;i<a1.length;i++){\n        if(typeof a1[i] != typeof a2[i]){\n            return false;\n        }\n        if(think.isObject(a1[i]) && think.isObject(a2[i])){\n            var retVal = o2o(a1[i],a2[i]);\n            if(!retVal){\n                return false;\n            }\n        }else if(think.isArray(a1[i]) && think.isArray(a2[i]) ){//recursion\n            if(!a2a(a1[i],a2[i])){\n                return false;\n            }\n        }else if(a1[i] !== a2[i]){\n            return false;\n        }\n    }\n    return true;\n}\n//生成6位的随机数\nglobal.MathRand = function ()\n{\n    var Num=\"\";\n    for(var i=0;i<6;i++)\n    {\n        Num+=Math.floor(Math.random()*10);\n    }\n    return Num;\n}\n\n//更新缓存\nglobal.update_cache =(type)=>{\n    switch (type){\n        case 'category':\n            //更新栏目缓存\n            think.cache(\"sys_category_list\",null);\n            think.cache(\"all_category\",null);\n            think.cache(\"all_priv\",null);//栏目权限缓存\n            break;\n        case 'channel'://更新频道缓存信息\n            think.cache(\"get_channel_cache\",null);\n            break;\n        case 'model':\n            think.cache(\"get_document_model\", null);//清除模型缓存\n            think.cache(\"get_model\", null);//清除模型缓存\n            break;\n    }\n}\n/**\n *缓存权限列表 all_priv\n * @param catid 要验证的栏目id\n * @param roleid 用户组\n * @param action 权限类型\n * @param is_admin 谁否前台 0前台，1后台\n * @param type true\n * @returns {bool} 返回flase 或true false:没权限，true:有权限。\n */\nglobal.priv = async(catid,roleid,action,is_admin=0,type=true)=>{\n    // console.log(catid);\n    // console.log(roleid);\n    // console.log(action);\n    // console.log(is_admin);\n    let priv = await think.model(\"category_priv\",think.config(\"db\")).priv(catid,roleid,action,is_admin,type);\n    //console.log(priv);\n    if(!priv){\n        return false;\n    }else {\n        return true;\n    }\n}\n\nglobal.GetDateStr=function (AddDayCount) {\n    var dd = new Date();\n    dd.setDate(dd.getDate()+AddDayCount);//获取AddDayCount天后的日期\n    var y = dd.getFullYear();\n    var m = (dd.getMonth()+1)<10?\"0\"+(dd.getMonth()+1):(dd.getMonth()+1);//获取当前月份的日期，不足10补0\n    var d = dd.getDate()<10?\"0\"+dd.getDate():dd.getDate();//获取当前几号，不足10补0\n    return y+\"-\"+m+\"-\"+d;\n}\n//转意符换成普通字符\nglobal.escape2Html=function (str) {\n    var arrEntities={'lt':'<','gt':'>','nbsp':' ','amp':'&','quot':'\"'};\n    return str.replace(/&(lt|gt|nbsp|amp|quot);/ig,function(all,t){return arrEntities[t];});\n}\nglobal.html_decode = function (str)\n{\n    var s = \"\";\n    if (str.length == 0) return \"\";\n    s = str.replace(/&gt;/g, \"&\");\n    s = s.replace(/&lt;/g, \"<\");\n    s = s.replace(/&gt;/g, \">\");\n    s = s.replace(/&nbsp;/g, \" \");\n    s = s.replace(/&#39;/g, \"\\'\");\n    s = s.replace(/&quot;/g, \"\\\"\");\n    s = s.replace(/<br>/g, \"\\n\");\n    return s;\n}\n\nglobal.html_encode = function (str)\n{\n    var s = \"\";\n    if (str.length == 0) return \"\";\n    s = str.replace(/&/g, \"&gt;\");\n    s = s.replace(/</g, \"&lt;\");\n    s = s.replace(/>/g, \"&gt;\");\n    s = s.replace(/ /g, \"&nbsp;\");\n    s = s.replace(/\\'/g, \"&#39;\");\n    s = s.replace(/\\\"/g, \"&quot;\");\n    s = s.replace(/\\n/g, \"<br>\");\n    return s;\n}"
    ]
}