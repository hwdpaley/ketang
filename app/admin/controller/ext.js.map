{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/ext.js"
    ],
    "names": [
        "init",
        "http",
        "db",
        "model",
        "tactive",
        "indexAction",
        "page",
        "get",
        "countSelect",
        "data",
        "Pages",
        "think",
        "adapter",
        "pages",
        "assign",
        "meta_title",
        "display",
        "addAction",
        "isPost",
        "post",
        "setting",
        "isEmpty",
        "installtime",
        "Date",
        "getTime",
        "valueOf",
        "updatetime",
        "add",
        "res",
        "success",
        "name",
        "url",
        "fail",
        "active",
        "editAction",
        "where",
        "ext",
        "update",
        "ids",
        "find",
        "info",
        "checkextAction",
        "count",
        "json"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/ext.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\n\nexport default class extends Base {\n  init(http) {\n    super.init(http);\n    this.db = this.model('ext');\n    this.tactive = \"ext\"\n  }\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async indexAction(){\n    //auto render template file index_index.html\n    let data = await this.db.page(this.get('page')).countSelect();\n    let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n    let pages = new Pages(this.http); //实例化 Adapter\n    let page = pages.pages(data);\n    this.assign('pagerData', page); //分页展示使用\n    this.assign('list', data.data);\n    this.meta_title = \"插件管理\";\n    return this.display();\n  }\n\n    /**\n     * 添加插件\n     * @returns {*}\n     */\n  async addAction(){\n        if(this.isPost()){\n            let data = this.post();\n            data.setting=\"{}\";\n            if(think.isEmpty(data.installtime)){\n             data.installtime = new Date().getTime();\n            }else {\n                data.installtime = new Date(data.installtime).valueOf();\n            }\n            if(think.isEmpty(data.updatetime)){\n                data.updatetime = new Date().getTime();\n            }else {\n                data.updatetime = new Date(data.updatetime).valueOf();\n            }\n            let res = await this.model(\"ext\").add(data);\n            if(res){\n                return this.success({name:\"添加插件成功！\",url:\"/admin/ext/index\"})\n            }else {\n                return this.fail(\"添加失败！\")\n            }\n        }else {\n            this.active=\"admin/ext/index\"\n            this.meta_title = \"新增插件\";\n            return this.display()\n        }\n\n  }\n\n    /**\n     * 更新插件\n     * @returns {*}\n     */\n  async editAction(){\n      if(this.isPost()){\n          let data = this.post();\n          data.setting=\"{}\";\n          if(think.isEmpty(data.updatetime)){\n              data.updatetime = new Date().getTime();\n          }else {\n              data.updatetime = new Date(data.updatetime).getTime();\n          }\n          let res = await this.model(\"ext\").where({ext:data.ext}).update(data);\n          if(res){\n              return this.success({name:\"更新插件成功！\"})\n          }else {\n              return this.fail(\"更新失败！\")\n          }\n      }else {\n          let ids = this.get(\"ids\");\n          let info = await this.model(\"ext\").where({ext:ids}).find();\n          this.assign(\"info\",info);\n          this.meta_title = \"更新插件\";\n          return this.display()\n      }\n  }\n    /**\n     * 验证同一张表是否存在相同的子段值\n     * @returns {*}\n     */\n  async checkextAction(){\n      let get = this.get();\n      // let key = think._.keys(get)[0];\n      // let val = get[key];\n      let res = await this.model(\"ext\").where(get).count(\"ext\");\n      if(res){\n          return this.json(0);\n      }else {\n          return this.json(1);\n      }\n  }\n}"
    ]
}