{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/mydwyg.js"
    ],
    "names": [
        "init",
        "http",
        "db",
        "model",
        "tactive",
        "indexAction",
        "session",
        "userInfo",
        "console",
        "log",
        "map",
        "groupid",
        "think",
        "isEmpty",
        "get",
        "real_name",
        "where",
        "page",
        "order",
        "countSelect",
        "data",
        "Pages",
        "adapter",
        "pages",
        "assign",
        "meta_title",
        "display",
        "kaoqinAction",
        "field",
        "select",
        "mmp",
        "v",
        "push",
        "id",
        "uid",
        "userlistAction",
        "gets",
        "start",
        "parseInt",
        "length",
        "draw",
        "key",
        "join",
        "table",
        "as",
        "on",
        "limit",
        "username",
        "status",
        "userList",
        "forEach",
        "last_login_time",
        "times",
        "last_login_ip",
        "_int2iP",
        "count",
        "json",
        "rechargeAction",
        "isAjax",
        "post",
        "increment",
        "balance",
        "res",
        "getField",
        "amount_log",
        "user",
        "Date",
        "valueOf",
        "get_nickname",
        "admin_id",
        "user_id",
        "type",
        "time",
        "amount",
        "note",
        "add",
        "success",
        "name",
        "fail",
        "adduserAction",
        "isPost",
        "password",
        "repassword",
        "encryptPassword",
        "reg_time",
        "getTime",
        "vip",
        "overduedate",
        "is_admin",
        "role_id",
        "usergroup",
        "role",
        "sendmessageAction",
        "message",
        "find",
        "openid",
        "cache",
        "action",
        "result",
        "in_array",
        "config",
        "error",
        "Error",
        "statusAction",
        "roleid",
        "edituserAction",
        "delavatar",
        "uploadPath",
        "RESOURCE_PATH",
        "path",
        "isFile",
        "rmdir",
        "thenAdd",
        "addrole",
        "update",
        "showuserAction",
        "userdelAction",
        "param",
        "isadmin",
        "chstaAction",
        "parsleyAction",
        "avatarAction",
        "pic",
        "readFileSync",
        "end"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/mydwyg.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\nimport fs from 'fs';\nexport default class extends Base {\n    /**\n     * index action\n     * @return {Promise} []\n     */\n    init(http) {\n            super.init(http);\n            this.db = this.model(\"member\");\n            this.tactive = \"mydwyg\";\n\n        }\n        /**\n         * 店务员工\n         * @returns {*}\n         */\n\n\n    async indexAction() {\n        let userInfo=await this.session('userInfo');\n        console.log(\"userinfo-------\"+JSON.stringify(userInfo));\n        let map = { 'status': ['>', -1],'groupid':userInfo.groupid,'client':0};\n        if (!think.isEmpty(this.get(\"client\"))) {\n            map = { 'status': ['>', -1],'groupid':userInfo.groupid,'client':1};\n        }\n        if (!think.isEmpty(this.get(\"username\"))) {\n            map.real_name = [\"like\", \"%\" + this.get(\"username\") + \"%\"];\n        }\n        let data = await this.db.where(map).page(this.get('page'), 20).order('id DESC').countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(this.http); //实例化 Adapter\n        let page = pages.pages(data);\n        // for(let v of data.data){\n        //     console.log(\"v-------\"+JSON.stringify(v.id));\n        //     v.role=await this.model(\"auth_role\").get_rolename(v.id);\n        //     console.log(\"v-------\"+JSON.stringify(v));\n        // }\n        this.assign('pagerData', page); //分页展示使用\n        this.assign('list', data.data);\n        this.meta_title = \"员工列表\";\n        if (!think.isEmpty(this.get(\"client\"))) {\n            this.meta_title = \"客户列表\";\n            this.assign('client',\"客户\");\n        }else{\n            this.assign('client', \"员工\");\n        }\n        \n        //获取管理组\n        // let role =await this.model(\"auth_role\").where({ status: 1 }).select();\n        // console.log(\"role-------\"+JSON.stringify(role));\n        // console.log(\"list-------\"+JSON.stringify(data.data));\n        // this.assign(\"role\", role);\n        return this.display();\n    }\n    async kaoqinAction() {\n        let userInfo=await this.session('userInfo');\n        \n        let map = { 'status': ['>', -1],'groupid':userInfo.groupid,'client':0};\n        if (!think.isEmpty(this.get(\"client\"))) {\n            map = { 'status': ['>', -1],'groupid':userInfo.groupid,'client':1};\n        }\n        if (!think.isEmpty(this.get(\"username\"))) {\n            map.real_name = [\"like\", \"%\" + this.get(\"username\") + \"%\"];\n        }\n        console.log(\"map-------\"+JSON.stringify(map));\n        let data = await this.db.where(map).field('id').order('id DESC').select();\n        console.log(\"data-------\"+JSON.stringify(data));\n        let mmp=[];\n        for(let v of data){\n            mmp.push(v.id);\n        }\n        map={uid:['IN',mmp]};\n        data = await this.model('member_kaoqin').where(map).order('kq_time DESC').select();\n        console.log(\"data-------\"+JSON.stringify(data));\n        // let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        // let pages = new Pages(this.http); //实例化 Adapter\n        // let page = pages.pages(data);\n        // for(let v of data.data){\n        //     console.log(\"v-------\"+JSON.stringify(v.id));\n        //     v.role=await this.model(\"auth_role\").get_rolename(v.id);\n        //     console.log(\"v-------\"+JSON.stringify(v));\n        // }\n        // this.assign('pagerData', page); //分页展示使用\n        this.assign('list', data);\n        this.meta_title = \"员工考勤列表\";\n        if (!think.isEmpty(this.get(\"client\"))) {\n            this.meta_title = \"客户考勤列表\";\n            this.assign('client',\"客户\");\n        }else{\n            this.assign('client', \"员工\");\n        }\n        \n        //获取管理组\n        // let role =await this.model(\"auth_role\").where({ status: 1 }).select();\n        // console.log(\"role-------\"+JSON.stringify(role));\n        // console.log(\"list-------\"+JSON.stringify(data.data));\n        // this.assign(\"role\", role);\n        return this.display(\"\");\n    }\n    async userlistAction() {\n        //用户列表\n        let gets = this.get()\n        let start = parseInt(gets.start);\n        let length = parseInt(gets.length);\n        let draw = gets.draw;\n        let key = gets['search[value]'];\n        let userList = await this.db.join({\n            table: \"customer\",\n            join: \"left\",\n            as: \"u\",\n            on: ['id', 'user_id']\n        }).field(\"id,username,score,login,last_login_ip,last_login_time,status,u.real_name,u.group_id,u.balance\").limit(start, length).where({ username: [\"like\", \"%\" + key + \"%\"], status: [\">\", -1] }).order(\"id DESC\").countSelect()\n        userList.data.forEach(v => {\n                v.last_login_time = times(v.last_login_time)\n                v.last_login_ip = _int2iP(v.last_login_ip)\n            })\n            //console.log(userList)\n        let data = {\n            \"draw\": draw,\n            \"recordsTotal\": userList.count,\n            \"recordsFiltered\": userList.count,\n            \"data\": userList.data\n        }\n        return this.json(data);\n    }\n\n    /**\n     * 会员充值\n     */\n    async rechargeAction() {\n            if (this.isAjax(\"POST\")) {\n                let data = this.post();\n                let res = await this.model(\"member\").where({ id: data.id }).increment(\"amount\", data.balance);\n                console.log(res);\n                if (res) {\n                    let amount_log = await this.model(\"member\").where({ id: data.id }).getField(\"amount\", true);\n                    console.log(amount_log);\n                    //充值成功后插入日志\n                    let log = {\n                        admin_id: this.user.uid,\n                        user_id: data.id,\n                        type: 2,\n                        time: new Date().valueOf(),\n                        amount: data.balance,\n                        amount_log: amount_log,\n                        note: `管理员（${await get_nickname(this.user.uid)}）为您充值，充值的金额为：${data.balance} 元`\n                    }\n                    await this.model('balance_log').add(log);\n                    return this.success({ name: \"充值成功！\" });\n                } else {\n                    return this.fail(\"充值失败！\");\n                }\n            } else {\n                let id = this.get(\"ids\");\n                let name = get_nickname(id);\n                this.assign(\"name\", name);\n                this.assign(\"id\", id);\n                this.meta_title = \"会员充值\";\n                return this.display();\n            }\n\n        }\n        /**\n         * adduser\n         * 添加用户\n         * @returns {Promise|*}\n         */\n    async adduserAction() {\n        if (this.isPost()) {\n            let data = this.post();\n            if (data.password != data.repassword) {\n                return this.fail(\"两次填入的密码不一致\");\n            }\n            data.password = encryptPassword(data.password);\n            data.reg_time = new Date().getTime();\n            if (data.vip == 1) {\n                data.overduedate = new Date(data.overduedate).getTime();\n            } else {\n                data.overduedate = think.isEmpty(data.overduedate) ? 0 : data.overduedate;\n            }\n            //  console.log(data);\n            // return this.fail(\"ddd\")\n            data.status = 1;\n            let res = await this.db.add(data);\n            if (res) {\n                //添加角色\n                if (data.is_admin == 1) {\n                    await this.model(\"auth_user_role\").add({ user_id: res, role_id: data.role_id });\n                }\n                return this.success({ name: \"添加成功！\" });\n            } else {\n                return this.fail(\"添加失败!\")\n            }\n        } else {\n            let userInfo=await this.session('userInfo');\n            //会员组\n            let usergroup = await this.model(\"member_group\").where({groupid:userInfo.groupid}).select();\n            this.assign(\"usergroup\", usergroup);\n            //获取管理组\n            let role =await this.model(\"auth_role\").where({ status: 1 }).select();\n            this.assign(\"role\", role);\n            if (!think.isEmpty(this.get(\"client\"))) {\n                this.meta_title = \"添加客户\";\n                this.assign('client',\"客户\");\n            }else{\n                this.meta_title = \"添加员工\";\n                this.assign('client',\"员工\");\n            }\n            \n            return this.display();\n        }\n\n    }\n    async sendmessageAction() {\n            if (this.isPost()) {\n                let data = this.post();\n                let message=data.message; \n                let res=await this.model(\"wx_user\").where({ uid: data.id }).find();\n                console.log(\"res----------\"+JSON.stringify(res));\n                let openid=res.openid;\n                if(think.isEmpty(openid)){\n                    return this.fail(\"用户信息不全！\");\n                }\n                await this.cache('getuserinfo',openid);\n                let result=await this.action(\"uc/wechat\", \"masssendtext\");\n                // let result=await this.action(\"uc/wechat\", \"getuserinfo\");\n                // let controllerInstance = this.controller(\"uc/wechat\");\n                // let result=await controllerInstance.getuserinfoAction(openid);\n                console.log(\"result----------\"+JSON.stringify(result));\n                return this.success({ name: \"消息发送成功！\"+openid });\n                \n            } else \n            {\n                let id = this.get(\"id\");\n                let user = await this.model(\"member\").find(id);\n                //不能修改超级管理员的信息\n                if (!this.is_admin) {\n                    if (in_array(id, this.config(\"user_administrator\"))) {\n                        this.http.error = new Error('您无权操作！');\n                        return think.statusAction(702, this.http);\n                    }\n\n                }\n                this.assign(\"user\", user);\n                console.log(user);\n                //所属管理组\n                if (user.is_admin == 1) {\n                    let roleid = await this.model(\"auth_user_role\").where({ user_id: user.id }).getField(\"role_id\", true);\n                    this.assign(\"roleid\", roleid)\n                }\n                //会员组\n                let usergroup = await this.model(\"member_group\").select();\n                this.assign(\"usergroup\", usergroup);\n                //获取管理组\n                let role = this.model(\"auth_role\").where({ status: 1 }).select();\n                this.assign(\"role\", role);\n                this.meta_title = \"发送消息\";\n                return this.display();\n            }\n        }\n        /**\n         * 编辑头像\n         * @returns {PreventPromise}\n         */\n    async edituserAction() {\n        if (this.isPost()) {\n            let data = this.post();\n            //删除头像\n            if (data.delavatar == 1) {\n                let uploadPath = think.RESOURCE_PATH + '/upload/avatar/' + data.id;\n                let path = think.isFile(uploadPath + \"/avatar.png\");\n                if (path) {\n                    think.rmdir(uploadPath, false)\n                }\n            }\n\n            if (think.isEmpty(data.password) && think.isEmpty(data.repassword)) {\n                delete data.password;\n            } else {\n                if (data.password != data.repassword) {\n                    return this.fail(\"两次填入的密码不一致\");\n                }\n                data.password = encryptPassword(data.password);\n            }\n            if (data.vip == 1) {\n                data.overduedate = new Date(data.overduedate).getTime();\n            } else {\n                data.overduedate = 0;\n            }\n            //添加角色\n            console.log(\"data-------\"+JSON.stringify(data));\n            if (data.is_admin == 1) {\n                let addrole = await this.model(\"auth_user_role\").where({ user_id: data.id }).thenAdd({ user_id: data.id, role_id: data.role_id });\n                console.log(\"addrole-------\"+JSON.stringify(addrole));\n                if (addrole.type == \"exist\") {\n                    console.log(\"auth_user_role update-------\");\n                    await this.model(\"auth_user_role\").update({ id: addrole.id, role_id: data.role_id });\n                }\n            }\n            let res = await this.db.update(data);\n\n            if (res) {\n                return this.success({ name: \"编辑成功！\" });\n            } else {\n                return this.fail(\"编辑失败!\")\n            }\n        } else {\n            let id = this.get(\"id\");\n            let user = await this.model(\"member\").find(id);\n            //不能修改超级管理员的信息\n            if (!this.is_admin) {\n                if (in_array(id, this.config(\"user_administrator\"))) {\n                    this.http.error = new Error('您无权操作！');\n                    return think.statusAction(702, this.http);\n                }\n\n            }\n            this.assign(\"user\", user);\n            console.log(\"user------------\"+JSON.stringify(user));\n            //所属管理组\n            if (user.is_admin == 1) {\n                let roleid = await this.model(\"auth_user_role\").where({ user_id: user.id }).getField(\"role_id\", true);\n                this.assign(\"roleid\", roleid)\n            }\n            //会员组\n            let usergroup = await this.model(\"member_group\").select();\n            this.assign(\"usergroup\", usergroup);\n            //获取管理组\n            let role = this.model(\"auth_role\").where({ status: 1 }).select();\n            this.assign(\"role\", role);\n            this.meta_title = \"编辑用户\";\n            return this.display();\n        }\n    }\n\n    /**\n     * 显示用户信息\n     * @returns {PreventPromise}\n     */\n    async showuserAction() {\n            let id = this.get(\"id\");\n            let user = await this.model(\"member\").find(id);\n            //非超级管理员只能修改自己的用户信息\n            // if(!this.is_admin){\n            //     if(this.user.uid!=id){\n            //         this.http.error = new Error('您无权操作！');\n            //         return think.statusAction(702, this.http);\n            //     }\n            //\n            // }\n            this.assign(\"user\", user);\n            console.log(user);\n            //所属管理组\n            if (user.is_admin == 1) {\n                let roleid = await this.model(\"auth_user_role\").where({ user_id: user.id }).getField(\"role_id\", true);\n                this.assign(\"roleid\", roleid)\n            }\n            //会员组\n            let usergroup = await this.model(\"member_group\").select();\n            this.assign(\"usergroup\", usergroup);\n            //获取管理组\n            let role = this.model(\"auth_role\").where({ status: 1 }).select();\n            this.assign(\"role\", role);\n            this.meta_title = \"个人信息\";\n            return this.display();\n        }\n        /**\n         * userdel\n         * 用户删除\n         * @returns {Promise|*}\n         */\n    async userdelAction() {\n            let id = this.param(\"ids\");\n            //console.log(id);\n            let res;\n            // 判断是否是管理员，如果是不能删除;\n            if (await this.isadmin(id)) {\n                return this.fail(\"不能删除管理员!\")\n            } else {\n                //res = await this.db.where({id: id}).delete();\n                //逻辑删除\n                res = await this.db.where({ id: [\"IN\", id] }).update({ status: -1 });\n                if (res) {\n                    return this.success({ name: \"删除成功！\" })\n                } else {\n                    return this.fail(\"删除失败！\")\n                }\n            }\n\n\n        }\n        /**\n         * 改变角色状态\n         * @returns {Promise|*}\n         */\n    async chstaAction() {\n        let res = await this.db.update(this.get());\n        if (res) {\n            return this.json(res);\n        }\n    }\n\n    /**\n     * 注册异步验证用户数据\n     * @returns {Promise|*}\n     */\n    async parsleyAction() {\n        //验证\n        let data = this.get();\n        // console.log(data);\n        let res = await this.db.where(data).find();\n        // console.log(res);\n        if (think.isEmpty(res)) {\n            return this.json(1);\n        } else {\n            return this.json(0);\n        }\n    }\n\n    /**\n     * 获取用户头像\n     */\n    async avatarAction() {\n        var uploadPath = think.RESOURCE_PATH + '/upload/avatar/' + this.user.uid;\n        let path = think.isFile(uploadPath + \"/\" + \"/avatar.png\");\n        this.type(\"image/png\");\n        let pic;\n        if (path) {\n            // this.download(uploadPath + \"/\" + \"/avatar.png\");\n            pic = fs.readFileSync(uploadPath + \"/\" + \"/avatar.png\")\n        } else {\n            //this.download(think.RESOURCE_PATH + '/upload/avatar/avatar.jpg')\n            pic = fs.readFileSync(think.RESOURCE_PATH + '/upload/avatar/avatar.jpg')\n        }\n        this.end(pic)\n    }\n\n}\n"
    ]
}