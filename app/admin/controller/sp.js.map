{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/sp.js"
    ],
    "names": [
        "init",
        "http",
        "tactive",
        "db",
        "model",
        "indexAction",
        "cate_id",
        "get",
        "think",
        "isEmpty",
        "error",
        "Error",
        "statusAction",
        "admin_priv",
        "get_category",
        "name",
        "get_parent_category",
        "nav",
        "assign",
        "find",
        "where",
        "cid",
        "info",
        "meta_title",
        "display",
        "mobileAction",
        "updateAction",
        "data",
        "post",
        "console",
        "log",
        "thenAdd",
        "isup",
        "type",
        "update",
        "success"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/sp.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\n\nexport default class extends Base {\n  init(http) {\n    super.init(http);\n    this.tactive = \"article\";\n    this.db = this.model(\"category_sp\");\n  }\n  /**\n   * index action\n   * @return {Promise} []\n   */\n async indexAction(){\n    let cate_id = this.get('cate_id') || null;\n    if(think.isEmpty(cate_id)){\n      this.http.error = new Error('该栏目不存在！');\n      return think.statusAction(702, this.http);\n    }\n      //权限验证\n      await this.admin_priv(\"init\",cate_id,\"您没有权限查看本栏目！\")\n    let name = await this.model(\"category\").get_category(cate_id, 'name')||cate_id;\n    //获取面包屑信息\n    let nav = await this.model('category').get_parent_category(cate_id);\n    this.assign('breadcrumb', nav);\n    //获取内容\n    //console.log(cate_id);\n    let info = await this.db.find({where:{cid:cate_id}});\n    //console.log(info);\n    //auto render template file index_index.html\n    this.meta_title = 'PC单页内容';\n    this.assign({\n      \"navxs\": true,\n      \"name\":name,\n      \"info\":info\n    });\n    return this.display();\n  }\n\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async mobileAction(){\n    let cate_id = this.get('cate_id') || null;\n    if(think.isEmpty(cate_id)){\n      this.http.error = new Error('该栏目不存在！');\n      return think.statusAction(702, this.http);\n    }\n      //权限验证\n      await this.admin_priv(\"init\",cate_id,\"您没有权限查看本栏目！\")\n    let name = await this.model(\"category\").get_category(cate_id, 'name')||cate_id;\n    //获取面包屑信息\n    let nav = await this.model('category').get_parent_category(cate_id);\n    this.assign('breadcrumb', nav);\n    //auto render template file index_index.html\n    let info = await this.db.find({where:{cid:cate_id}});\n    this.meta_title = '手机单页内容';\n    this.assign({\n      \"navxs\": true,\n      \"name\":name,\n      \"info\":info\n    });\n    return this.display();\n  }\n\n  //编辑\n  async updateAction(){\n    let data = this.post();\n      console.log(data);\n      //权限验证\n      await this.admin_priv(\"edit\",data.cid);\n      let isup = await this.db.thenAdd(data, {cid:data.cid});\n    if(isup.type == 'exist'){\n      await this.db.update(data, {where:{cid:data.cid}})\n    }\n    return this.success({name:\"编辑成功！\"})\n  }\n}"
    ]
}