{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/mpbase1.js"
    ],
    "names": [
        "init",
        "http",
        "indexAction",
        "meta_title",
        "assign",
        "display",
        "setingAction",
        "map",
        "is_admin",
        "uid",
        "user",
        "model",
        "where",
        "page",
        "get",
        "countSelect",
        "data",
        "Pages",
        "think",
        "adapter",
        "pages",
        "console",
        "log",
        "val",
        "get_nickname",
        "huifuAction",
        "isPost",
        "post",
        "isEmpty",
        "api",
        "self",
        "getUser",
        "err",
        "result",
        "success",
        "name",
        "url",
        "error",
        "fail",
        "materialAction",
        "get_sub_category",
        "subcat",
        "select",
        "cate",
        "testAction",
        "wapi",
        "uploadMaterial",
        "res",
        "end",
        "createlocalAction",
        "setstatusAction"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/mpbase1.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\nimport weiapi from 'wechat-api';\n\nexport default class extends Base {\n\n    //var a = 1;\n\n    /**\n    * index action\n    * @return {Promise} []\n    */\n    init(http) {\n        super.init(http);\n\n    }\n    /**\n     * index action\n     * @return {Promise} []\n     */\n\n    indexAction() {\n        //auto render template file index_index.html\n        this.meta_title = '微信管理';\n        this.assign({\"navxs\": true,\"bg\": \"bg-dark\"});\n        return this.display();\n    }\n    /**\n     * 公众账号管理\n     */\n    *setingAction() {\n        let map = { 'status': ['>', -1] }\n        if (!this.is_admin()) {//管理员可以管理全部公共账号\n            map.uid = this.user.uid;\n        }\n\n        let data = yield this.model('member_public').where(map).page(this.get('page')).countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(); //实例化 Adapter\n        let page = pages.pages(data);\n        this.assign('pagerData', page); //分页展示使用\n        this.assign('list', data.data);\n        console.log(data.data);\n        for(let val of data.data){\n            val.uid = yield this.model('member').get_nickname(val.uid);\n        }\n        this.assign({\"navxs\": true,\"bg\": \"bg-dark\"});\n        this.meta_title = \"公共账号管理\";\n        return this.display();\n    }\n\n\n     * huifuAction(){\n        if(this.isPost()){\n            let post = this.post();\n             if(!think.isEmpty(post)){\n                post =  JSON.stringify(post);\n                 let api = new weiapi('wxf417a542a02aa8fc', '564033623a2ea9b19119f0164289ba45');\n                 /*api.sendText('oJMTsw7cOcQRr32Cze3nDQ9mJKCU', 'Hello world', (err, result)=>{\n                     console.log(\"hehe\");\n                 });*/\n                 let self = this;\n                 api.getUser(\"oJMTsw7cOcQRr32Cze3nDQ9mJKCU\", (err,result)=>{\n                     if(think.isEmpty(err)){\n                         think.log(result,\"fds\");\n                         self.success({name:result,url:\"/admin/mpbase1/huifu\"});\n                     }else{\n                         console.error(err);\n                     }\n\n                 });\n                 //this.success({name:post,url:\"/admin/mpbase1\"});\n             }else{\n                 this.fail(\"信息不能为空\");\n             }\n        }else{\n         this.meta_title=\"自动回复\";\n         this.assign({\"navxs\": true,\"bg\": \"bg-dark\"});\n         return this.display();\n         }\n        }\n\n    /**\n    * 素材管理\n    * */\n    async materialAction() {\n        //conosle.log(this.a);\n        this.meta_title=\"素材管理\";\n        this.assign({\"navxs\": true,\"bg\": \"bg-dark\"});\n        //let cat=await this.model('category').get_category(1,\"url\");\n        //获取某个栏目的所有子栏目\n        let subcat = await this.model('category').get_sub_category(1);\n        let cate = await this.model('category').select();\n        //let treecat = arr_to_tree(cate,42)\n        //console.log(treecat)\n        this.display();\n    }\n\n    /**\n     *测试\n     */\n    testAction(){\n        let wapi = new weiapi(\"wxf417a542a02aa8fc\", \"564033623a2ea9b19119f0164289ba45\");\n        let self = this;\n        wapi.uploadMaterial('F:\\\\nodejs-www\\\\CmsWing\\\\www\\\\static\\\\admin\\\\img\\\\m0.jpg', \"image\", function(err, res){\n            think.log(res);\n            console.log(\"err= \"+err);\n            self.end(res);\n        });\n        //this.end();\n    }\n\n    /**\n     *新建图文\n     */\n    createlocalAction(){\n        this.meta_title=\"新建高级图文\";\n        this.assign({\"navxs\": true,\"bg\": \"bg-dark\"});\n        this.display();\n    }\n\n    /**\n     * 设置一条或者多条数据的状态\n     */\n    * setstatusAction() {\n        yield super.setstatusAction(this,'member_public');\n    }\n\n}\n"
    ]
}