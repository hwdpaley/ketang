{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/order.js"
    ],
    "names": [
        "init",
        "http",
        "tactive",
        "indexAction",
        "display",
        "listAction",
        "status",
        "get",
        "map",
        "think",
        "isEmpty",
        "assign",
        "is_del",
        "type",
        "model",
        "where",
        "page",
        "order",
        "countSelect",
        "data",
        "Pages",
        "adapter",
        "pages",
        "active",
        "val",
        "payment",
        "channel",
        "id",
        "getField",
        "meta_title",
        "auditAction",
        "isPost",
        "post",
        "admin_remark",
        "update",
        "audit",
        "success",
        "name",
        "url",
        "header",
        "fail",
        "delAction",
        "delete",
        "res",
        "voidAction",
        "voids",
        "stock",
        "finishAction",
        "finish",
        "remarkAction",
        "remark",
        "seeAction",
        "console",
        "log",
        "find",
        "order_id",
        "select",
        "goods",
        "sum",
        "title",
        "JSON",
        "parse",
        "prom_goods",
        "pic",
        "price",
        "push",
        "goods_nums",
        "eval",
        "join",
        "user_id",
        "user",
        "express_company",
        "olde_order_amount",
        "real_amount",
        "real_freight",
        "parent_id",
        "province",
        "city",
        "county",
        "editAction",
        "order_amount",
        "Number",
        "adjust_amount",
        "order_no",
        "uid",
        "ip",
        "pay_status",
        "item",
        "delivery_status",
        "customer",
        "on",
        "shipAction",
        "get_nickname",
        "admin",
        "kid",
        "Date",
        "getTime",
        "invoice_no",
        "create_time",
        "add",
        "vieworderAction",
        "list",
        "receivingAction",
        "payment_id",
        "invoiceAction",
        "v",
        "express_company_id",
        "refundAction"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/order.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\n\nexport default class extends Base {\n    init(http){\n        super.init(http);\n        this.tactive = \"order\"\n    }\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  indexAction(){\n    //auto render template file index_index.html\n    \n    return this.display();\n  }\n  //订单列表\n  async listAction(){\n        let status = this.get(\"status\");\n        let map={};\n        if(!think.isEmpty(status)){\n            map.status = status;\n            this.assign('status',status);\n        }\n\n        map.is_del = 0\n        map.type = 0;\n       // this.config(\"db.nums_per_page\",20)\n        let data = await this.model(\"order\").where(map).page(this.get('page')).order(\"create_time DESC\").countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(this.http); //实例化 Adapter\n        let page = pages.pages(data);\n        this.assign('pagerData', page); //分页展示使用\n        //console.log(data.data);\n        this.active=\"admin/order/list\";\n        for(let val of data.data){\n            switch (val.payment){\n                case 100:\n                    val.channel = \"预付款支付\";\n                    break;\n                case 1001:\n                    val.channel = \"货到付款\";\n                    break;\n                default:\n                    val.channel = await this.model(\"pingxx\").where({id:val.payment}).getField(\"title\",true);\n            }\n        }\n        this.assign('list', data.data);\n        this.meta_title = \"订单管理\";\n        return this.display();\n  }\n\n    /**\n     * 审核订单\n     */\n    async auditAction(){\n        if(this.isPost()){\n            let id = this.post(\"id\");\n            let admin_remark = this.post(\"admin_remark\");\n            let audit =await this.model(\"order\").where({id:id}).update({status:3,admin_remark:admin_remark});\n            if(audit){\n                return this.success({name:\"审核成功！\",url:this.http.header[\"referer\"]})\n            }else {\n                return this.fail(\"审核失败！\")\n            }\n\n        }else {\n            let id = this.get(\"id\");\n            this.assign(\"id\",id);\n            this.meta_title = \"审核订单\";\n            return this.display();\n        }\n    }\n\n    /**\n     * 删除订单\n     */\n    async delAction(){\n        let id = this.get(\"id\");\n        //作废的订单才能删除\n        let res =await this.model(\"order\").where({id:id,status:6}).delete();\n        if(res){\n            return this.success({name:\"删除成功！\"});\n        }else {\n            return this.fail(\"删除失败！\");\n        }\n    }\n    /**\n     * 作废订单\n     */\n    async voidAction(){\n        if(this.isPost()){\n            let id = this.post(\"id\");\n            let admin_remark = this.post(\"admin_remark\");\n            let voids =await this.model(\"order\").where({id:id}).update({status:6,admin_remark:admin_remark});\n            if(voids){\n                //释放库存\n                await this.model(\"order\").stock(id,false);\n                return this.success({name:\"操作成功！\",url:this.http.header[\"referer\"]})\n            }else {\n                return this.fail(\"操作失败！\")\n            }\n\n        }else {\n            let id = this.get(\"id\");\n            this.assign(\"id\",id);\n            this.meta_title = \"审核订单\";\n            return this.display();\n        }\n    }\n    /**\n     * 完成订单\n     */\n    async finishAction(){\n        if(this.isPost()){\n            let id = this.post(\"id\");\n            let admin_remark = this.post(\"admin_remark\");\n            let finish =await this.model(\"order\").where({id:id}).update({status:4,admin_remark:admin_remark});\n            if(finish){\n                return this.success({name:\"操作成功！\",url:this.http.header[\"referer\"]})\n            }else {\n                return this.fail(\"操作失败！\")\n            }\n\n        }else {\n            let id = this.get(\"id\");\n            this.assign(\"id\",id);\n            this.meta_title = \"完成订单\";\n            return this.display();\n        }\n    }\n\n    /**\n     * 备注订单\n     */\n    async remarkAction(){\n        if(this.isPost()){\n            let id = this.post(\"id\");\n            let admin_remark = this.post(\"admin_remark\");\n            let remark =await this.model(\"order\").where({id:id}).update({admin_remark:admin_remark});\n            if(remark){\n                return this.success({name:\"操作成功！\",url:this.http.header[\"referer\"]})\n            }else {\n                return this.fail(\"操作失败！\")\n            }\n\n        }else {\n            let id = this.get(\"id\");\n            this.assign(\"id\",id);\n            this.meta_title = \"备注订单\";\n            return this.display();\n        }\n    }\n    /**\n     * 查看订单\n     * @returns {*}\n     */\n   async seeAction(){\n       let id = this.get(\"id\");\n       console.log(id);\n       this.meta_title = \"查看订单\";\n       //获取订单信息\n       let order = await this.model(\"order\").find(id);\n       //购物清单\n       let goods = await this.model(\"order_goods\").where({order_id:id}).select();\n       let sum = [];\n       for(let val of goods){\n           val.title = JSON.parse(val.prom_goods).title;\n           val.pic = JSON.parse(val.prom_goods).pic;\n           val.type = JSON.parse(val.prom_goods).type;\n           val.sum = JSON.parse(val.prom_goods).price;\n           sum.push(val.goods_nums);\n       }\n       sum = eval(sum.join('+'));\n       this.assign(\"sum\",sum);\n       this.assign(\"goods\",goods);\n       //获取购买人信息\n       //购买人信息\n       let user = await this.model(\"member\").find(order.user_id);\n       this.assign(\"user\",user);\n       //订单信息\n       switch (order.payment){\n           case 100:\n               order.payment = \"预付款支付\";\n               break;\n           case 1001:\n               order.payment = \"货到付款\";\n               break;\n           default:\n               order.payment = await this.model(\"pingxx\").where({id:order.payment}).getField(\"title\",true);\n       }\n       this.assign(\"order\",order);\n       //获取 快递公司\n       let express_company = this.model(\"express_company\").order(\"sort ASC\").select();\n       this.assign(\"express_company\",express_company);\n       //获取省份\n       /**\n        * 订单原价 = 商品真实价格 + 真实运费\n        */\n       let olde_order_amount = order.real_amount + order.real_freight\n       this.assign(\"olde_order_amount\",olde_order_amount);\n       let province = await this.model('area').where({parent_id:0}).select();\n       let city = await this.model('area').where({parent_id:order.province}).select();\n       let county = await this.model('area').where({parent_id:order.city}).select();\n       this.assign(\"province\",province);\n       this.assign(\"city\",city);\n       this.assign(\"county\",county);\n       return this.display();\n   }\n    /**\n     * 编辑订单\n     */\n    async editAction(){\n        if(this.isPost()){\n          let data = this.post()\n\n            let order = await this.model(\"order\").find(data.id);\n            /**\n             * 订单原价 = 商品真实价格 + 真实运费\n             */\n            let olde_order_amount = order.real_amount + order.real_freight;\n            data.order_amount =  Number(olde_order_amount)+Number(data.adjust_amount);\n            //更新订单信息\n            let res = await this.model(\"order\").update(data);\n            if(res){\n                //记录日志\n                let log;\n                if(data.adjust_amount==0){\n                    log = `修改了订单，订单编号：${order.order_no}`\n                }else {\n                    log = `修改了订单，订单编号：${order.order_no}，并调整订单金额 ${data.adjust_amount} 元，原订单金额：${olde_order_amount} 元，调整后订单金额：${data.order_amount} 元`\n                }\n\n                await this.model(\"action\").log(\"order\",\"order\",log,this.user.uid,this.ip(),this.http.url);\n                return this.success({name:\"编辑成功！\"});\n            }else {\n                return this.fail(\"编辑失败！\");\n            }\n        }else {\n            let id = this.get(\"id\");\n            console.log(id);\n            this.meta_title = \"编辑订单\";\n            //获取订单信息\n            let order = await this.model(\"order\").find(id);\n            //在订单同时没有付款，没有审核，没有完成的情况下才能编辑\n            if(order.pay_status == 1 && item.status == 3 && item.delivery_status == 1){\n                return this.fail(\"订单已经付款，无法编辑！\");\n            }\n\n            //购物清单\n            let goods = await this.model(\"order_goods\").where({order_id:id}).select();\n            let sum = [];\n            for(let val of goods){\n                val.title = JSON.parse(val.prom_goods).title;\n                val.pic = JSON.parse(val.prom_goods).pic;\n                val.type = JSON.parse(val.prom_goods).type;\n                val.sum = JSON.parse(val.prom_goods).price;\n                sum.push(val.goods_nums);\n            }\n            sum = eval(sum.join('+'));\n            this.assign(\"sum\",sum);\n            this.assign(\"goods\",goods);\n            //获取购买人信息\n            //购买人信息\n            let user = await this.model(\"member\").join({\n                customer: {\n                    on: [\"id\", \"user_id\"]\n                }\n            }).find(order.user_id);\n            this.assign(\"user\",user);\n            //订单信息\n            switch (order.payment){\n                case 100:\n                    order.payment = \"预付款支付\";\n                    break;\n                case 1001:\n                    order.payment = \"货到付款\";\n                    break;\n                default:\n                    order.payment = await this.model(\"pingxx\").where({id:order.payment}).getField(\"title\",true);\n            }\n            this.assign(\"order\",order);\n            //获取 快递公司\n            let express_company = this.model(\"express_company\").order(\"sort ASC\").select();\n            this.assign(\"express_company\",express_company);\n            //获取省份\n            /**\n             * 订单原价 = 商品真实价格 + 真实运费\n             */\n            let olde_order_amount = order.real_amount + order.real_freight\n            this.assign(\"olde_order_amount\",olde_order_amount);\n            let province = await this.model('area').where({parent_id:0}).select();\n            let city = await this.model('area').where({parent_id:order.province}).select();\n            let county = await this.model('area').where({parent_id:order.city}).select();\n            this.assign(\"province\",province);\n            this.assign(\"city\",city);\n            this.assign(\"county\",county);\n            return this.display();\n        }\n    }\n    /**\n     * 发货设置\n     */\n    async shipAction(){\n        if(this.isPost()){\n            let data = this.post();\n            data.admin = await get_nickname(this.user.uid);\n            //生成快递单编号\n            let kid = ['k',new Date().getTime()]\n            data.invoice_no = kid.join(\"\");\n            \n            data.create_time = new Date().getTime();\n            let res = await this.model(\"doc_invoice\").add(data);\n            if(res){\n                await this.model(\"order\").where({id:data.order_id}).update({delivery_status:1});\n            }\n            return this.success({\"name\":\"发货成功！\",\"url\":this.http.header[\"referer\"]});\n        }else {\n            let id = this.get(\"id\");\n            let order = await this.model(\"order\").find(id);\n            if(order.status != 3 ){\n                return this.fail(\"订单还没审核！，请先审核订单。\")\n            }\n            switch (order.payment){\n                case 100:\n                    order.payment = \"预付款支付\";\n                    break;\n                case 1001:\n                    order.payment = \"货到付款\";\n                    break;\n                default:\n                    order.payment = await this.model(\"pingxx\").where({id:order.payment}).getField(\"title\",true);\n            }\n            //购物清单\n            let goods = await this.model(\"order_goods\").where({order_id:id}).select();\n            let sum=[]\n            for(let val of goods){\n                val.title = JSON.parse(val.prom_goods).title;\n                val.pic = JSON.parse(val.prom_goods).pic;\n                val.type = JSON.parse(val.prom_goods).type;\n                val.sum = JSON.parse(val.prom_goods).price;\n                sum.push(val.goods_nums);\n            }\n\n            //购买人信息\n            let user = await this.model(\"member\").find(order.user_id);\n            //获取 快递公司\n            let express_company = this.model(\"express_company\").order(\"sort ASC\").select();\n            this.assign(\"express_company\",express_company);\n            //获取省份\n            let province = await this.model('area').where({parent_id:0}).select();\n            let city = await this.model('area').where({parent_id:order.province}).select();\n            let county = await this.model('area').where({parent_id:order.city}).select();\n            this.assign(\"province\",province);\n            this.assign(\"city\",city);\n            this.assign(\"county\",county);\n            this.assign(\"user\",user);\n            sum = eval(sum.join('+'));\n            this.assign(\"sum\",sum);\n            console.log(goods);\n            this.assign(\"goods\",goods);\n            this.assign(\"order\",order);\n            this.meta_title = \"发货\";\n            return this.display();\n        }\n    }\n    /**\n     * 查看订单\n     */\n    vieworderAction(){\n        let list = [1,2,3];\n        this.assign(\"list\",list);\n        return this.display();\n    }\n\n    /**\n     * 收款单\n     */\n\n    async receivingAction(){\n        let data = await this.model(\"doc_receiving\").page(this.get('page')).order(\"create_time DESC\").countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(this.http); //实例化 Adapter\n        let page = pages.pages(data);\n        this.assign('pagerData', page); //分页展示使用\n        //console.log(data.data);\n        // this.active=\"admin/order/list\"\n        for(let val of data.data){\n            switch (val.payment_id){\n                case 100:\n                    val.channel = \"预付款支付\";\n                    break;\n                case 1001:\n                    val.channel = \"货到付款\";\n                    break;\n                default:\n                    val.channel = await this.model(\"pingxx\").where({id:val.payment_id}).getField(\"title\",true);\n            }\n            val.order_id=await this.model(\"order\").where({id:val.order_id}).getField(\"order_no\",true);\n        }\n        this.assign('list', data.data);\n        // this.active=\"admin/order/receiving\"\n        this.meta_title = \"收款单\";\n        return this.display();\n    }\n\n    /**\n     * 发货单\n     */\n    async invoiceAction(){\n    \n        let data = await this.model(\"doc_invoice\").page(this.get('page')).order(\"create_time DESC\").countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(this.http); //实例化 Adapter\n        let page = pages.pages(data);\n        this.assign('pagerData', page); //分页展示使用\n        for(let v of data.data){\n            v.express_company_id = await this.model(\"express_company\").where({id:v.express_company_id}).getField(\"name\",true);\n        }\n        this.assign(\"list\",data.data);\n        this.active=\"admin/order/receiving\"\n        this.meta_title = \"发货单\";\n        return this.display();\n    }\n\n    /**\n     * 退款单\n     */\n\n    refundAction(){\n\n\n        this.active=\"admin/order/receiving\"\n        this.meta_title = \"退款单\";\n        return this.display();\n    }\n\n}"
    ]
}