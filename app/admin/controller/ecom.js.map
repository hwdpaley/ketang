{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/ecom.js"
    ],
    "names": [
        "init",
        "http",
        "tactive",
        "indexAction",
        "display",
        "pingxxAction",
        "app_id",
        "setup",
        "PINGXX_APP_ID",
        "livesecretkey",
        "PINGXX_LIVE_SECRET_KEY",
        "assign",
        "model",
        "order",
        "select",
        "channel",
        "meta_title",
        "addappidAction",
        "isAjax",
        "appid",
        "post",
        "where",
        "name",
        "update",
        "value",
        "res",
        "think",
        "cache",
        "success",
        "fail",
        "addlivesecretkeyAction",
        "rsaAction",
        "type",
        "param",
        "console",
        "log",
        "path",
        "RESOURCE_PATH",
        "rsa",
        "writeFileSync",
        "readFileSync",
        "webhokksAction",
        "config",
        "url",
        "host",
        "paymentAction",
        "page",
        "get",
        "countSelect",
        "data",
        "Pages",
        "adapter",
        "pages",
        "val",
        "id",
        "plugin_id",
        "getField",
        "logo",
        "editpayAction",
        "find",
        "info",
        "addpayAction",
        "add",
        "delpayAction",
        "delete",
        "isEmpty",
        "paypluginAction",
        "active",
        "fareAction",
        "list",
        "addfareAction",
        "editfareAction",
        "isNumberString",
        "defaulffareAction",
        "is_default",
        "delfareAction",
        "fareareaAction",
        "field",
        "arr_to_tree",
        "json",
        "expressAction",
        "addexpressAction",
        "isPost",
        "editexpressAction",
        "delexpressAction",
        "ids",
        "setstatusAction",
        "table"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/ecom.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\nimport Fs from 'fs';\nexport default class extends Base {\n    //支付与配送控制区\n     init(http){\n        super.init(http);\n        this.tactive = \"ecom\"\n    }\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  indexAction(){\n    //auto render template file index_index.html\n    return this.display();\n  }\n\n    /**\n     * ping++支付\n      */\n   async pingxxAction(){\n        //获取app_id\n        let app_id = this.setup.PINGXX_APP_ID;\n        let livesecretkey = this.setup.PINGXX_LIVE_SECRET_KEY;\n        this.assign(\"app_id\",app_id);\n        this.assign(\"livesecretkey\",livesecretkey);\n        //获取支付渠道\n        let channel = await this.model('pingxx').order('sort ASC').select();\n        //console.log(channel);\n        this.assign(\"channel\",channel);\n        this.meta_title = \"ping++支付设置\";\n       return this.display();\n    }\n    // 添加appid\n    async addappidAction(){\n        if(this.isAjax(\"POST\")){\n          let appid = this.post('appid');\n            let res = await this.model(\"setup\").where({name:'PINGXX_APP_ID'}).update({value:appid});\n            if(res){\n                think.cache(\"setup\", null);//清除设置缓存\n               return this.success({name:\"设置成功！\"});\n            }else {\n               return this.fail(\"设置失败！\");\n            }\n        }else {\n            this.meta_title=\"添加App_ID\";\n            return this.display();\n        }\n    }\n    async addlivesecretkeyAction(){\n        if(this.isAjax(\"POST\")){\n            let appid = this.post('livesecretkey');\n            let res = await this.model(\"setup\").where({name:'PINGXX_LIVE_SECRET_KEY'}).update({value:appid});\n            if(res){\n                think.cache(\"setup\", null);//清除设置缓存\n                return this.success({name:\"设置成功！\"});\n            }else {\n                return this.fail(\"设置失败！\");\n            }\n        }else {\n            this.meta_title=\"添加Live Secret Key\";\n            return this.display();\n        }\n    }\n    //配置商户私钥\n    rsaAction(){\n        let type = this.param(\"type\");\n        console.log(type);\n        let path ;\n        switch (type){\n            case \"private\":\n                path =  think.RESOURCE_PATH + \"/upload/pingpp/bieber_rsa_private_key.pem\";\n                break;\n            default:\n                path =  think.RESOURCE_PATH + \"/upload/pingpp/pingpp_rsa_public_key.pem\";\n\n        }\n\n        if(this.isAjax(\"POST\")){\n            let rsa = this.post(\"rsa\");\n            console.log(path);\n            //return false;\n            if(type == \"private\"){\n            //console.log(rsa);\n            Fs.writeFileSync(path, rsa, 'utf8');\n            return this.success({name:\"设置成功！\"});\n            }else {\n                Fs.writeFileSync(path, rsa, 'utf8');\n                return this.success({name:\"设置成功！\"});\n            }\n        }else {\n            if(type == \"private\"){\n                let rsa = Fs.readFileSync(path, null);\n                this.assign(\"rsa\",rsa);\n                this.meta_title=\"配置商户私钥\";\n            }else {\n                let rsa = Fs.readFileSync(path, null);\n                this.assign(\"rsa\",rsa);\n                this.meta_title=\"Ping++ 公钥\";\n            }\n            this.assign(\"type\",type);\n            return this.display();\n        }\n\n    }\n    //Webhooks\n    async webhokksAction (){\n\n            let config =[\n                {name:\"支付成功\",url:`${this.http.host}/uc/pay/webhooks`}\n            ]\n        this.assign(\"list\",config);\n        this.meta_title=\"Webhooks\";\n        return this.display();\n    }\n  /**\n   * 正在使用的支付方式\n   */\n async paymentAction(){\n    this.meta_title=\"正在使用的支付方式\";\n    let data = await this.model(\"payment\").page(this.get('page')).countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(this.http); //实例化 Adapter\n        let page = pages.pages(data);\n        for(let val of data.data){\n           val.logo =  await this.model(\"pay_plugin\").where({id:val.plugin_id}).getField(\"logo\",true);\n        }\n        this.assign('pagerData', page); //分页展示使用\n        this.assign('list', data.data);\n       return this.display();\n  }\n  /**编辑支付方式 */\n async editpayAction(){\n     if(this.isAjax(\"POST\")){\n         let data = this.post();\n        let res = await this.model(\"payment\").update(data);\n        if(res){\n            return this.success({name:'编辑支付方式成功！',url: \"/admin/ecom/payment\"});\n        }else{\n            return this.fail( '编辑支付方式失败！');\n            \n        }\n     }else{\n           let id = this.get(\"id\");\n    let info = await this.model(\"payment\").find(id);\n    this.assign(\"info\",info);\n    this.meta_title = \"配置支付方式\";\n    return this.display();\n     }\n  }\n   /**添加支付方式 */\n async addpayAction(){\n    if(this.isAjax(\"POST\")){\n        let data = this.post();\n        let res = await this.model(\"payment\").add(data);\n        if(res){\n            return this.success({name:'添加支付方式成功！',url: \"/admin/ecom/payment\"});\n        }else{\n            return this.fail( '添加支付方式失败！');\n            \n        }\n    }else{\n           let id = this.get(\"id\");\n    let info = await this.model(\"pay_plugin\").find(id);\n    this.assign(\"info\",info);\n    this.meta_title = \"添加支付方式\";\n   return this.display();\n    }\n \n  }\n  /**删除正在使用的支付方式 */\n  async delpayAction(){\n      let id = this.get(\"id\");\n      let res = await this.model(\"payment\").where({id:id}).delete();\n      if(!think.isEmpty(res)){\n        return this.success({name:'删除成功！'});\n          \n      }else{\n          return this.fail('删除失败！'); \n          \n      }\n  }\n  \n  /**支付插件 */\n  \n  async paypluginAction(){\n    this.meta_title=\"全部支付方式\";\n    // this.end(11);\n     this.active = \"admin/ecom/payment\";\n     let data = await this.model(\"pay_plugin\").page(this.get('page')).countSelect();\n     let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n     let pages = new Pages(this.http); //实例化 Adapter\n     let page = pages.pages(data); \n     this.assign('pagerData', page); //分页展示使用\n     this.assign('list', data.data);\n    return this.display(); \n  }\n  /**运费模板 */\n async fareAction(){\n      this.meta_title=\"运费模板\";\n      let list = await this.model(\"fare\").page(this.get('page')).order(\"is_default DESC\").countSelect();\n      let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n      let pages = new Pages(this.http); //实例化 Adapter\n      let page = pages.pages(list);\n      //console.log(list);\n      this.assign('pagerData', list); //分页展示使用\n      this.assign('list', list.data);\n      return this.display();\n  }\n\n    /**\n     * 添加运费模板\n     */\n\n    async addfareAction(){\n        if(this.isAjax(\"POST\")){\n            let data = this.post();\n            let res = await this.model('fare').add(data);\n            if(res){\n                return this.success({name:\"添加运费模板成功！\",url:\"/admin/ecom/fare\"})\n            }else {\n                return this.fail(\"添加运费模板失败！\")\n            }\n        }else{\n            this.meta_title=\"添加运费模板\";\n            this.active=\"admin/ecom/fare\";\n            return this.display();\n        }\n\n    }\n    //编辑运费模板\n    async editfareAction(){\n        if(this.isAjax(\"POST\")){\n            let data = this.post();\n            let res = await this.model(\"fare\").update(data);\n            if(res){\n                return this.success({name:\"编辑运费模板成功！\",url:\"/admin/ecom/fare\"})\n            }else {\n                return this.fail(\"编辑运费模板失败！\")\n            }\n        }else {\n            let id = this.get('id');\n            if(!think.isNumberString(id)){\n                return this.fail(\"哦也！\")\n            }\n            let res = await this.model(\"fare\").find(id);\n            if(res){\n                this.assign(\"info\",res);\n            }else {\n                return this.fail(\"您选择的运费模板已经被删除！\")\n            }\n            this.meta_title=\"编辑运费模板\";\n            this.active = \"admin/ecom/fare\";\n            return this.display();\n        }\n    }\n    //设置默认使用的模板\n    async defaulffareAction(){\n           let id =this.get(\"id\");\n           await this.model('fare').where(\"1=1\").update({is_default: 0});\n           let update = await this.model(\"fare\").where({id:id}).update({is_default:1});\n           if(update){\n               return this.success({name:\"设置成功！\"})\n           }else {\n               return this.fail(\"设置失败！\")\n           }\n    }\n    //删除运费模板\n    async delfareAction(){\n        let id = this.get(\"id\");\n        let res  = await this.model(\"fare\").where({id:id}).delete();\n        if(res){\n            return this.success({name:\"删除模板成功！\"})\n        }else {\n            return this.fail(\"删除模板失败！\")\n        }\n    }\n    /**\n     * 选择配送地区\n     */\n    async fareareaAction(){\n        if(this.isAjax(\"POST\")){\n            let data = await this.model(\"area\").field(\"id,name,parent_id as pid,sort\").select();\n            data = arr_to_tree(data,0);\n            //for(let val of data){\n            //    val.pId =val.pid;\n            //}\n            return this.json(data);\n        }else {\n            this.assign('id',this.get(\"id\"));\n            this.meta_title=\"选择配送地区\";\n            return this.display();\n        }\n\n    }\n    /**快递公司管理 */\n  async expressAction(){\n        let data = await this.model(\"express_company\").page(this.get('page'),20).countSelect();\n        let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n        let pages = new Pages(this.http); //实例化 Adapter\n        let page = pages.pages(data);\n        this.assign('pagerData', page); //分页展示使用\n        this.assign('list', data.data);\n        this.meta_title=\"快递公司管理\";\n        this.active=\"admin/ecom/express\"\n    return this.display();\n  }\n\n    /**\n     * 新增快递公司\n     */\n  async addexpressAction(){\n      if(this.isPost()){\n          let data = this.post();\n          let res = await this.model('express_company').add(data);\n          if(res){\n              return this.success({name:\"添加成功!\"});\n          }else {\n              return this.fail(\"添加失败!\")\n          }\n      }\n      else {\n          this.meta_title=\"添加快递公司\";\n          return this.display();\n      }\n\n\n  }\n\n    /**\n     * 编辑快递公司\n     * @returns {Promise.<void>}\n     */\n  async editexpressAction(){\n      if(this.isPost()){\n          let data = this.post();\n          let res = await this.model(\"express_company\").update(data);\n          if(res){\n              return this.success({name:\"更新成功!\"});\n          }else {\n              return this.fail(\"更新失败!\")\n          }\n      }else {\n          let id = this.get(\"id\");\n          let info = await this.model(\"express_company\").find(id);\n          this.assign(\"info\",info);\n          this.meta_title = \"编辑快递公司\";\n          return this.display();\n      }\n  }\n\n    /**\n     * 删除快递公司\n     * @returns {Promise.<void>}\n     */\n  async delexpressAction(){\n      let ids = this.param(\"ids\");\n      let res = await this.model(\"express_company\").where({id:['IN',ids]}).delete();\n      if(res){\n          return this.success({name:\"删除成功!\"})\n      }else {\n          return this.fail(\"删除失败!\")\n      }\n\n  }\n  /**\n     * 设置一条或者多条数据的状态\n     */\n    async setstatusAction() {\n        let table = this.get(\"table\");\n        await super.setstatusAction(this,table);\n    }\n    \n}"
    ]
}