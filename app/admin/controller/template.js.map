{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/template.js"
    ],
    "names": [
        "init",
        "http",
        "tactive",
        "__before",
        "get_temp_group",
        "assign",
        "indexAction",
        "meta_title",
        "display",
        "homeAction",
        "model",
        "where",
        "isdefault",
        "getField",
        "gid",
        "map",
        "module",
        "controller",
        "action",
        "type",
        "param",
        "find",
        "temp",
        "temppath",
        "think",
        "ROOT_PATH",
        "templateFile",
        "config",
        "undefined",
        "isPost",
        "data",
        "post",
        "id",
        "container",
        "name",
        "console",
        "log",
        "pid",
        "baktime",
        "Date",
        "getTime",
        "lastuser",
        "user",
        "uid",
        "html",
        "add",
        "bak",
        "update",
        "res",
        "isEmpty",
        "writeFileSync",
        "success",
        "fail",
        "tempbakAction",
        "get",
        "limit",
        "order",
        "select",
        "list",
        "tempreplyAction",
        "channelAction",
        "page",
        "countSelect",
        "Pages",
        "adapter",
        "pages",
        "columnAction",
        "detailAction",
        "spAction",
        "incAction",
        "editAction",
        "indexOf",
        "active",
        "addAction",
        "temptype",
        "file_depr",
        "delAction",
        "isFile",
        "unlinkSync",
        "delete",
        "isdel",
        "group"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/template.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\n// | Bieber [ 美媒网站内容管理框架 ]\n// +----------------------------------------------------------------------\n// | Copyright (c) 2017 http://www.gzxinbibo.com All rights reserved.\n// +----------------------------------------------------------------------\n// | Author: Tony <912697590@qq.com>\n// +----------------------------------------------------------------------\n'use strict';\n\nimport Base from './base.js';\nimport fs from 'fs';\nexport default class extends Base {\n async init(http) {\n    super.init(http);\n    this.tactive = \"template\";\n    // 当前使用的模版组\n\n  }\n  //init\n  async __before(){\n      await super.__before();\n      //获取模板组\n      await this.get_temp_group();\n      this.assign({\n          \"navxs\":true,\n      });\n  }\n  /**\n   * index action\n   * @return {Promise} []\n   */\n  async indexAction(){\n    //auto render template file index_index.html\n    this.meta_title= '模板管理';\n    return this.display();\n  }\n\n  /**\n   * 网站首页模版编辑\n   * @returns {*}\n     */\n  async homeAction(){\n      let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n    let map ={\n      module:\"topic\",\n      controller:\"index\",\n      action:\"index\",\n      type:this.param(\"type\")||1,\n      gid:gid\n    }\n    let temp = await this.model(\"temp\").where(map).find();\n      let temppath;\n      if(temp.type==2){\n           temppath = `${think.ROOT_PATH}/view/${temp.module}/mobile/`;\n      }else {\n          temppath = `${think.ROOT_PATH}/view/${temp.module}/`;\n      }\n    let templateFile = `${temppath}${temp.controller}${think.config(\"view.file_depr\",undefined,\"topic\")}${temp.action}${this.config(\"view.file_ext\")}`;\n     if(this.isPost()){\n       let data = this.post();\n       data.id= temp.id;\n       data.module = map.module;\n       data.controller= map.container;\n       data.action = map.action;\n       data.name = temp.name;\n       data.type = temp.type;\n       data.gid = temp.gid;\n       console.log(data);\n       //await this.model(\"temp\").add(data);\n       temp.pid = temp.id;\n       delete temp.id;\n       temp.baktime = new Date().getTime();\n       temp.lastuser = this.user.uid;\n       console.log(temp);\n         // return false;\n       //修改前先备份\n       if(data.html!=temp.html){\n         let bak = await this.model(\"temp_bak\").add(temp);\n         let res = await this.model(\"temp\").update(data);\n         if(!think.isEmpty(res)){\n           fs.writeFileSync(templateFile, data.html);\n           return this.success({name:\"添加成功!\"})\n         }\n       }else {\n         return this.fail(\"请先修改模板!\")\n       }\n\n     }else {\n       //首页网站编辑\n       //console.log(this.adminmenu[\"10\"]);\n       this.meta_title= '首页模板';\n\n       console.log(templateFile)\n       //let tempcon = fs.readFileSync(templateFile,\"utf8\");\n\n       console.log(temp);\n       this.assign('temp',temp);\n       return this.display();\n     }\n\n  }\n//模板修改记录\n async tempbakAction(){\n     let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n    let map = this.get();\n    map.gid = gid;\n    let list = await this.model(\"temp_bak\").where(map).limit(20).order(\"baktime DESC\").select();\n   this.assign(\"list\",list);\n   this.assign(\"title\",\"修改记录\");\n    return this.display();\n  }\n  //还原模板\n  async tempreplyAction(){\n    let id = this.get(\"id\");\n    let bak =await this.model(\"temp_bak\").where({pid:id}).find();\n    if(!think.isEmpty(bak)){\n      delete bak.id;\n      await this.model(\"temp\").where({id:id}).update(bak);\n        let temppath;\n        if(bak.type==2){\n            temppath = `${think.ROOT_PATH}/view/${bak.module}/mobile/`;\n        }else {\n            temppath = `${think.ROOT_PATH}/view/${bak.module}/`;\n        }\n      let templateFile = `${temppath}${bak.controller}${think.config(\"view.file_depr\",undefined,\"topic\")}${bak.action}${this.config(\"view.file_ext\")}`;\n      fs.writeFileSync(templateFile, bak.html);\n    }\n    return this.success({name:\"还原成功!\"})\n  }\n    //封面模板\n async channelAction(){\n     let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n     let map ={\n         module:\"topic\",\n         controller:\"cover\",\n         type:this.param(\"type\")||1,\n         gid:gid\n     }\n     let temp = await this.model(\"temp\").where(map).page(this.get('page')).countSelect();\n     let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n     let pages = new Pages(this.http); //实例化 Adapter\n     let page = pages.pages(temp);\n     this.assign('pagerData', page); //分页展示使用\n     this.assign('list', temp.data);\n     \n    this.meta_title= '封面模板';\n\n    return this.display();\n  }\n  //栏目模版\n async columnAction(){\n     let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n     let map ={\n         module:\"topic\",\n         controller:\"list\",\n         type:this.param(\"type\")||1,\n         gid:gid\n     }\n     let temp = await this.model(\"temp\").where(map).page(this.get('page')).countSelect();\n     let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n     let pages = new Pages(this.http); //实例化 Adapter\n     let page = pages.pages(temp);\n     this.assign('pagerData', page); //分页展示使用\n     this.assign('list', temp.data);\n    this.meta_title= '列表模板';\n\n    return this.display();\n  }\n  //详情模版\n async detailAction(){\n     let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n      let map ={\n          module:\"topic\",\n          controller:\"detail\",\n          type:this.param(\"type\")||1,\n          gid:gid\n      }\n      let temp = await this.model(\"temp\").where(map).page(this.get('page')).countSelect();\n      let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n      let pages = new Pages(this.http); //实例化 Adapter\n      let page = pages.pages(temp);\n      this.assign('pagerData', page); //分页展示使用\n      this.assign('list', temp.data);\n    this.meta_title='内容模板'\n\n    return this.display();\n  }\n  //单页模版\n    async spAction(){\n        let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n        let map = {\n            module:\"topic\",\n            controller:\"sp\",\n            type:this.param(\"type\")||1,\n            gid:gid\n        }\n        console.log(map);\n        let temp = await this.model(\"temp\").where(map).page(this.get('page')).countSelect();\n        console.log(temp);\n        let Pages = think.adapter(\"pages\",\"page\");\n        let pages = new Pages(this.http);\n        let page = pages.pages(temp);\n        this.assign('pagerData',page);\n        this.assign('list',temp.data);\n        this.meta_title='单页模版';\n        return this.display();\n    }\n  //公共模版\n async incAction(){\n     let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n     let map ={\n         module:\"topic\",\n         controller:\"inc\",\n         type:this.param(\"type\")||1,\n         gid:gid\n     }\n     let temp = await this.model(\"temp\").where(map).page(this.get('page')).countSelect();\n     let Pages = think.adapter(\"pages\", \"page\"); //加载名为 dot 的 Template Adapter\n     let pages = new Pages(this.http); //实例化 Adapter\n     let page = pages.pages(temp);\n     this.assign('pagerData', page); //分页展示使用\n     this.assign('list', temp.data);\n    this.meta_title='公共模板';\n\n      return this.display();\n  }\n    //编辑模板\n  async editAction(){\n      let id = this.param(\"id\");\n      let temp = await this.model(\"temp\").find(id);\n      if(this.isPost()){\n          temp.pid = temp.id;\n          delete temp.id;\n          temp.baktime = new Date().getTime();\n          temp.lastuser = this.user.uid;\n       let data = this.post();\n          let temppath;\n          if(temp.type==2){\n              temppath = `${think.ROOT_PATH}/view/${temp.module}/mobile/`;\n          }else {\n              temppath = `${think.ROOT_PATH}/view/${temp.module}/`;\n          }\n          let templateFile = `${temppath}${temp.controller}${think.config(\"view.file_depr\",undefined,\"topic\")}${temp.action}${this.config(\"view.file_ext\")}`;\n          console.log(data);\n          console.log(temp);\n          console.log(templateFile);\n          //检查是否修改内容\n          if(data.html==temp.html){\n              return this.fail(\"请先修改模板!\")\n          }else {\n              let bak = await this.model(\"temp_bak\").add(temp);\n              let res = await this.model(\"temp\").update(data);\n              if(!think.isEmpty(res)){\n                  fs.writeFileSync(templateFile, data.html);\n                  return this.success({name:\"修改成功!\"})\n              }\n          }\n      }else {\n\n          if(temp.action.indexOf(\"index\")==0&&temp.controller=='topic'){\n              this.active = \"admin/template/channel\"\n          }\n          if(temp.action.indexOf(\"list\")==0){\n              this.active = \"admin/template/column\"\n          }\n          if(temp.action.indexOf(\"detail\")==0){\n              this.active = \"admin/template/detail\"\n          }\n          if(temp.controller=='sp'){\n              this.active = \"admin/template/sp\"\n          }\n          this.meta_title=\"修改模板\"\n          this.assign({\n              \"navxs\":true,\n              \"temp\":temp\n          });\n          return this.display();\n      }\n\n    }\n    //添加模板\n    async addAction(){\n        let gid = await this.model(\"temp_group\").where({isdefault:1}).getField(\"gid\",true);\n        if(this.isPost()){\n            let data = this.post();\n            switch (data.temptype){\n                case \"channel\":\n                    data.module= 'topic';\n                    data.controller= 'cover';\n                    data.gid= gid;\n                    break;\n                case \"column\":\n                    data.module= 'topic';\n                    data.controller= 'list';\n                    data.gid= gid;\n                    break;\n                case \"detail\":\n                    data.module= 'topic';\n                    data.controller= 'detail';\n                    data.gid= gid;\n                    break;\n                case \"inc\":\n                    data.module= 'topic';\n                    data.controller= 'inc';\n                    data.gid= gid;\n                    break;\n                case \"sp\":\n                    data.module = 'topic';\n                    data.controller = 'sp';\n                    data.gid = gid;\n                    break;\n            }\n\n            let temppath;\n            if(data.type==2){\n                temppath = `${think.ROOT_PATH}/view/${data.module}/mobile/`;\n            }else {\n                temppath = `${think.ROOT_PATH}/view/${data.module}/`;\n            }\n            let templateFile = `${temppath}${data.controller}${think.config(\"view\",undefined,\"topic\").file_depr}${data.action}${this.config(\"view.file_ext\")}`;\n            console.log(templateFile);\n            let res = await this.model(\"temp\").add(data);\n            if(!think.isEmpty(res)){\n                fs.writeFileSync(templateFile, data.html);\n                return this.success({name:\"添加成功!\"})\n            }\n        }else {\n            let type = this.get(\"type\");\n            let temptype = this.get(\"temptype\");\n            switch (temptype){\n                case \"channel\":\n                    this.assign(\"title\",\"封面模板\");\n                    break;\n                case \"column\":\n                    this.assign(\"title\",\"列表模板\");\n                    break;\n                case \"detail\":\n                    this.assign(\"title\",\"内容模板\");\n                    break;\n                case \"inc\":\n                    this.assign(\"title\",\"公共模板\");\n                    break;\n                case \"sp\":\n                    this.assign(\"title\",\"单页模版\");\n                    break\n            }\n            this.active = \"admin/template/\"+temptype;\n            this.meta_title = \"添加模板\"\n            this.assign({\n                \"navxs\":true,\n                \"type\":type,\n                \"temptype\":temptype\n            });\n            return this.display();\n        }\n\n    }\n\n    /**\n     * 删除模版\n     */\n    async delAction(){\n        let id = this.get(\"id\");\n        let temp = await this.model(\"temp\").find(id);\n        //console.log(temp);\n        let temppath;\n        if(temp.type==2){\n            temppath = `${think.ROOT_PATH}/view/${temp.module}/mobile/`;\n        }else {\n            temppath = `${think.ROOT_PATH}/view/${temp.module}/`;\n        }\n        let templateFile = `${temppath}${temp.controller}${think.config(\"view\",undefined,\"topic\").file_depr}${temp.action}${this.config(\"view.file_ext\")}`;\n        //console.log(templateFile);\n        if(think.isFile(templateFile)){\n            fs.unlinkSync(templateFile);\n        }\n        let isdel = await this.model(\"temp\").delete(id);\n        if(isdel){\n            return this.success({name:\"删除成功!\"});\n        }else {\n            return this.fail(\"删除失败!\")\n        }\n    }\n  // 获取模版组\n  async get_temp_group(){\n    let group = this.model(\"temp_group\").select();\n    this.assign(\"temp_group\",group);\n  }\n}"
    ]
}